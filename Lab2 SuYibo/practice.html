<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>practice</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-86daaaaad7353f9cc0c554efc1dd6d94.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-089d33cf698baaaf9f41b12d6983a4fc.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles/index.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Index</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About Me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./homework.html"> 
<span class="menu-text">Homework</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./labs.html"> 
<span class="menu-text">Labs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./practice.html" aria-current="page"> 
<span class="menu-text">Practice</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/SuYibo7/SuYibo-Homework/blob/main/README.md"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    <div class="quarto-alternate-notebooks"><h2>Notebooks</h2><ul><li><a href="labs/Practice/Practice4-preview.html"><i class="bi bi-journal-code"></i>compile返回的是匹配到的模式对象</a></li><li><a href="labs/Practice/analysis_dataset-preview.html"><i class="bi bi-journal-code"></i>Create a dictionary with the data in</a></li><li><a href="labs/Practice/Practice3.2-preview.html"><i class="bi bi-journal-code"></i>Downloading imdb top 250 movie's data</a></li><li><a href="labs/Practice/recreate_graph-preview.html"><i class="bi bi-journal-code"></i>recreate_graph.ipynb</a></li><li><a href="labs/Practice/Empirical-preview.html"><i class="bi bi-journal-code"></i>You don't need to use these settings yourself</a></li><li><a href="labs/Practice/Practice3.3-preview.html"><i class="bi bi-journal-code"></i>定义请求的 URL 和 headers</a></li><li><a href="labs/Practice/Practice3.1-preview.html"><i class="bi bi-journal-code"></i>替换为你的 FRED API key</a></li></ul></div></div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<section id="practice2-analysis_dataset" class="level1">
<h1>Practice2-analysis_dataset</h1>
<div class="quarto-embed-nb-cell">
<div id="cell-0" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pingouin <span class="im">as</span> pg</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> lets_plot <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>LetsPlot.setup_html(no_js<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-1" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dictionary with the data in</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Copenhagen"</span>: [<span class="fl">14.1</span>, <span class="fl">14.1</span>, <span class="fl">13.7</span>, <span class="fl">12.9</span>, <span class="fl">12.3</span>, <span class="fl">11.7</span>, <span class="fl">10.8</span>, <span class="fl">10.6</span>, <span class="fl">9.8</span>, <span class="fl">5.3</span>],</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Dniprop"</span>: [<span class="fl">11.0</span>, <span class="fl">12.6</span>, <span class="fl">12.1</span>, <span class="fl">11.2</span>, <span class="fl">11.3</span>, <span class="fl">10.5</span>, <span class="fl">9.5</span>, <span class="fl">10.3</span>, <span class="fl">9.0</span>, <span class="fl">8.7</span>],</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Minsk"</span>: [<span class="fl">12.8</span>, <span class="fl">12.3</span>, <span class="fl">12.6</span>, <span class="fl">12.3</span>, <span class="fl">11.8</span>, <span class="fl">9.9</span>, <span class="fl">9.9</span>, <span class="fl">8.4</span>, <span class="fl">8.3</span>, <span class="fl">6.9</span>],</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame.from_dict(data)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Copenhagen</th>
<th data-quarto-table-cell-role="th">Dniprop</th>
<th data-quarto-table-cell-role="th">Minsk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>14.1</td>
<td>11.0</td>
<td>12.8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>14.1</td>
<td>12.6</td>
<td>12.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>13.7</td>
<td>12.1</td>
<td>12.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>12.9</td>
<td>11.2</td>
<td>12.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>12.3</td>
<td>11.3</td>
<td>11.8</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-2" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df.plot(ax<span class="op">=</span>ax)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Average contribution to public goods game: without punishment"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Average contribution"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Round"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>Text(0.5, 0, 'Round')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="practice_files/figure-html/labs-Practice-analysis_dataset-cell-4-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-3" class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data_np <span class="op">=</span> pd.read_excel(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"D:</span><span class="ch">\360</span><span class="st">MoveData\Users</span><span class="ch">\75</span><span class="st">903\Desktop\SuYibo-Homework\Practice2 SuYibo/Public-goods-experimental-data.xlsx"</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    usecols<span class="op">=</span><span class="st">"A:Q"</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    header<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    index_col<span class="op">=</span><span class="st">"Period"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>data_n <span class="op">=</span> data_np.iloc[:<span class="dv">10</span>, :].copy()</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>data_p <span class="op">=</span> data_np.iloc[<span class="dv">14</span>:<span class="dv">24</span>, :].copy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-4" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"City A"</span>: [<span class="fl">14.1</span>, <span class="fl">14.1</span>, <span class="fl">13.7</span>],</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"City B"</span>: [<span class="fl">11.0</span>, <span class="fl">12.6</span>, <span class="fl">12.1</span>],</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Original dataframe</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>test_df <span class="op">=</span> pd.DataFrame.from_dict(test_data)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># A copy of the dataframe</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>test_copy <span class="op">=</span> test_df.copy()</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># A pointer to the dataframe</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>test_pointer <span class="op">=</span> test_df</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>test_pointer.iloc[<span class="dv">1</span>, <span class="dv">1</span>] <span class="op">=</span> <span class="dv">99</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-5" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"test_df="</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>test_df<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"test_copy="</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>test_copy<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>test_df=
   City A  City B
0    14.1    11.0
1    14.1    99.0
2    13.7    12.1

test_copy=
   City A  City B
0    14.1    11.0
1    14.1    12.6
2    13.7    12.1
</code></pre>
</div>
</div>
<div id="cell-6" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data_n.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 10 entries, 1 to 10
Data columns (total 16 columns):
 #   Column           Non-Null Count  Dtype 
---  ------           --------------  ----- 
 0   Copenhagen       10 non-null     object
 1   Dnipropetrovs’k  10 non-null     object
 2   Minsk            10 non-null     object
 3   St. Gallen       10 non-null     object
 4   Muscat           10 non-null     object
 5   Samara           10 non-null     object
 6   Zurich           10 non-null     object
 7   Boston           10 non-null     object
 8   Bonn             10 non-null     object
 9   Chengdu          10 non-null     object
 10  Seoul            10 non-null     object
 11  Riyadh           10 non-null     object
 12  Nottingham       10 non-null     object
 13  Athens           10 non-null     object
 14  Istanbul         10 non-null     object
 15  Melbourne        10 non-null     object
dtypes: object(16)
memory usage: 1.3+ KB</code></pre>
</div>
</div>
<div id="cell-7" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>data_n <span class="op">=</span> data_n.astype(<span class="st">"double"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>data_p <span class="op">=</span> data_p.astype(<span class="st">"double"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-8" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>mean_n_c <span class="op">=</span> data_n.mean(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>mean_p_c <span class="op">=</span> data_p.agg(np.mean, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-9" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>mean_n_c.plot(ax<span class="op">=</span>ax, label<span class="op">=</span><span class="st">"Without punishment"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>mean_p_c.plot(ax<span class="op">=</span>ax, label<span class="op">=</span><span class="st">"With punishment"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Average contribution to public goods game"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Average contribution"</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>ax.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="practice_files/figure-html/labs-Practice-analysis_dataset-cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-10" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>partial_names_list <span class="op">=</span> [<span class="st">"F. Kennedy"</span>, <span class="st">"Lennon"</span>, <span class="st">"Maynard Keynes"</span>, <span class="st">"Wayne"</span>]</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>[<span class="st">"John "</span> <span class="op">+</span> name <span class="cf">for</span> name <span class="kw">in</span> partial_names_list]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>['John F. Kennedy', 'John Lennon', 'John Maynard Keynes', 'John Wayne']</code></pre>
</div>
</div>
<div id="cell-11" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new dataframe with bars in</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>compare_grps <span class="op">=</span> pd.DataFrame(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    [mean_n_c.loc[[<span class="dv">1</span>, <span class="dv">10</span>]], mean_p_c.loc[[<span class="dv">1</span>, <span class="dv">10</span>]]],</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span>[<span class="st">"Without punishment"</span>, <span class="st">"With punishment"</span>],</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns to have "round" in them</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>compare_grps.columns <span class="op">=</span> [<span class="st">"Round "</span> <span class="op">+</span> <span class="bu">str</span>(i) <span class="cf">for</span> i <span class="kw">in</span> compare_grps.columns]</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># flip cols and index round ready for plotting (.T is transpose)</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>compare_grps <span class="op">=</span> compare_grps.T</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a bar chart</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>compare_grps.plot.bar(rot<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="practice_files/figure-html/labs-Practice-analysis_dataset-cell-13-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-12" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>n_c <span class="op">=</span> data_n.agg([<span class="st">"std"</span>, <span class="st">"var"</span>, <span class="st">"mean"</span>], <span class="dv">1</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>n_c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">var</th>
<th data-quarto-table-cell-role="th">mean</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Period</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>2.020724</td>
<td>4.083325</td>
<td>10.578313</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>2.238129</td>
<td>5.009220</td>
<td>10.628398</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>2.329569</td>
<td>5.426891</td>
<td>10.407079</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>2.068213</td>
<td>4.277504</td>
<td>9.813033</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>2.108329</td>
<td>4.445049</td>
<td>9.305433</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>2.240881</td>
<td>5.021549</td>
<td>8.454844</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>2.136614</td>
<td>4.565117</td>
<td>7.837568</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>2.349442</td>
<td>5.519880</td>
<td>7.376388</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>2.413845</td>
<td>5.826645</td>
<td>6.392985</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>2.187126</td>
<td>4.783520</td>
<td>4.383769</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-13" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>p_c <span class="op">=</span> data_p.agg([<span class="st">"std"</span>, <span class="st">"var"</span>, <span class="st">"mean"</span>], <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-14" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>n_c[<span class="st">"mean"</span>].plot(ax<span class="op">=</span>ax, label<span class="op">=</span><span class="st">"mean"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># mean + 2 sd</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>(n_c[<span class="st">"mean"</span>] <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> n_c[<span class="st">"std"</span>]).plot(ax<span class="op">=</span>ax, ylim<span class="op">=</span>(<span class="dv">0</span>, <span class="va">None</span>), color<span class="op">=</span><span class="st">"red"</span>, label<span class="op">=</span><span class="st">"±2 s.d."</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># mean - 2 sd</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>(n_c[<span class="st">"mean"</span>] <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> n_c[<span class="st">"std"</span>]).plot(ax<span class="op">=</span>ax, ylim<span class="op">=</span>(<span class="dv">0</span>, <span class="va">None</span>), color<span class="op">=</span><span class="st">"red"</span>, label<span class="op">=</span><span class="st">""</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(data_n.columns)):</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    ax.scatter(x<span class="op">=</span>data_n.index, y<span class="op">=</span>data_n.iloc[:, i], color<span class="op">=</span><span class="st">"k"</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Average contribution"</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Contribution to public goods game without punishment"</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="practice_files/figure-html/labs-Practice-analysis_dataset-cell-16-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-15" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>p_c[<span class="st">"mean"</span>].plot(ax<span class="op">=</span>ax, label<span class="op">=</span><span class="st">"mean"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># mean + 2 sd</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>(p_c[<span class="st">"mean"</span>] <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> p_c[<span class="st">"std"</span>]).plot(ax<span class="op">=</span>ax, ylim<span class="op">=</span>(<span class="dv">0</span>, <span class="va">None</span>), color<span class="op">=</span><span class="st">"red"</span>, label<span class="op">=</span><span class="st">"±2 s.d."</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># mean - 2 sd</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>(p_c[<span class="st">"mean"</span>] <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> p_c[<span class="st">"std"</span>]).plot(ax<span class="op">=</span>ax, ylim<span class="op">=</span>(<span class="dv">0</span>, <span class="va">None</span>), color<span class="op">=</span><span class="st">"red"</span>, label<span class="op">=</span><span class="st">""</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(data_p.columns)):</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    ax.scatter(x<span class="op">=</span>data_p.index, y<span class="op">=</span>data_p.iloc[:, i], color<span class="op">=</span><span class="st">"k"</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Average contribution"</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Contribution to public goods game without punishment"</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="practice_files/figure-html/labs-Practice-analysis_dataset-cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-16" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>data_p.<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.<span class="bu">max</span>() <span class="op">-</span> x.<span class="bu">min</span>(), axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>Period
1     10.199675
2     12.185065
3     12.689935
4     12.625000
5     12.140375
6     12.827541
7     13.098931
8     13.482621
9     13.496754
10    11.307360
dtype: float64</code></pre>
</div>
</div>
<div id="cell-17" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A lambda function accepting three inputs, a,b and c and calculating the sum of the squares</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>test_function <span class="op">=</span> <span class="kw">lambda</span> a, b, c: a<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> b<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> c<span class="op">**</span><span class="dv">2</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we apply the function by handing over (in parenthesis) the following inputs: a=3, b=4 and c=5</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>test_function(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>50</code></pre>
</div>
</div>
<div id="cell-18" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>range_function <span class="op">=</span> <span class="kw">lambda</span> x: x.<span class="bu">max</span>() <span class="op">-</span> x.<span class="bu">min</span>()</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>range_p <span class="op">=</span> data_p.<span class="bu">apply</span>(range_function, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>range_n <span class="op">=</span> data_n.<span class="bu">apply</span>(range_function, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-19" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>range_p.plot(ax<span class="op">=</span>ax, label<span class="op">=</span><span class="st">"With punishment"</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>range_n.plot(ax<span class="op">=</span>ax, label<span class="op">=</span><span class="st">"Without punishment"</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="dv">0</span>, <span class="va">None</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Range of contributions to the public goods game"</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="practice_files/figure-html/labs-Practice-analysis_dataset-cell-21-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-20" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>funcs_to_apply <span class="op">=</span> [range_function, <span class="st">"max"</span>, <span class="st">"min"</span>, <span class="st">"std"</span>, <span class="st">"mean"</span>]</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>summ_p <span class="op">=</span> data_p.<span class="bu">apply</span>(funcs_to_apply, axis<span class="op">=</span><span class="dv">1</span>).rename(columns<span class="op">=</span>{<span class="st">"&lt;lambda&gt;"</span>: <span class="st">"range"</span>})</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>summ_n <span class="op">=</span> data_n.<span class="bu">apply</span>(funcs_to_apply, axis<span class="op">=</span><span class="dv">1</span>).rename(columns<span class="op">=</span>{<span class="st">"&lt;lambda&gt;"</span>: <span class="st">"range"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-21" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>summ_n.loc[[<span class="dv">1</span>, <span class="dv">10</span>], :].<span class="bu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">range</th>
<th data-quarto-table-cell-role="th">max</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">mean</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Period</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>6.14</td>
<td>14.10</td>
<td>7.96</td>
<td>2.02</td>
<td>10.58</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>7.38</td>
<td>8.68</td>
<td>1.30</td>
<td>2.19</td>
<td>4.38</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-22" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>summ_p.loc[[<span class="dv">1</span>, <span class="dv">10</span>], :].<span class="bu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">range</th>
<th data-quarto-table-cell-role="th">max</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">mean</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Period</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>10.20</td>
<td>16.02</td>
<td>5.82</td>
<td>3.21</td>
<td>10.64</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>11.31</td>
<td>17.51</td>
<td>6.20</td>
<td>3.90</td>
<td>12.87</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-23" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>pg.ttest(x<span class="op">=</span>data_n.iloc[<span class="dv">0</span>, :], y<span class="op">=</span>data_p.iloc[<span class="dv">0</span>, :])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">T</th>
<th data-quarto-table-cell-role="th">dof</th>
<th data-quarto-table-cell-role="th">alternative</th>
<th data-quarto-table-cell-role="th">p-val</th>
<th data-quarto-table-cell-role="th">CI95%</th>
<th data-quarto-table-cell-role="th">cohen-d</th>
<th data-quarto-table-cell-role="th">BF10</th>
<th data-quarto-table-cell-role="th">power</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">T-test</td>
<td>-0.063782</td>
<td>30</td>
<td>two-sided</td>
<td>0.949567</td>
<td>[-2.0, 1.87]</td>
<td>0.02255</td>
<td>0.337</td>
<td>0.050437</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-24" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>pg.ttest(x<span class="op">=</span>data_n.iloc[<span class="dv">0</span>, :], y<span class="op">=</span>data_p.iloc[<span class="dv">0</span>, :], paired<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">T</th>
<th data-quarto-table-cell-role="th">dof</th>
<th data-quarto-table-cell-role="th">alternative</th>
<th data-quarto-table-cell-role="th">p-val</th>
<th data-quarto-table-cell-role="th">CI95%</th>
<th data-quarto-table-cell-role="th">cohen-d</th>
<th data-quarto-table-cell-role="th">BF10</th>
<th data-quarto-table-cell-role="th">power</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">T-test</td>
<td>-0.149959</td>
<td>15</td>
<td>two-sided</td>
<td>0.882795</td>
<td>[-0.92, 0.8]</td>
<td>0.02255</td>
<td>0.258</td>
<td>0.05082</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<a class="quarto-notebook-link" id="nblink-1" href="labs/Practice/analysis_dataset-preview.html#cell-0">Source: Create a dictionary with the data in</a></div>
</section>
<section id="practice3-empirical" class="level1">
<h1>Practice3-Empirical</h1>
<div class="quarto-embed-nb-cell">
<div id="cell-0" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pingouin <span class="im">as</span> pg</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> lets_plot <span class="im">import</span> <span class="op">*</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>LetsPlot.setup_html(no_js<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-1" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">### You don't need to use these settings yourself</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co">### — they are just here to make the book look nicer!</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the plot style for prettier charts:</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.style.use(</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co">#    "https://raw.githubusercontent.com/aeturrell/core_python/main/plot_style.txt"</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co">#)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-2" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Python Walkthrough 1.1</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://data.giss.nasa.gov/gistemp/tabledata_v4/NH.Ts+dSST.csv"</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    skiprows<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    na_values<span class="op">=</span><span class="st">"***"</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-3" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Jan</th>
<th data-quarto-table-cell-role="th">Feb</th>
<th data-quarto-table-cell-role="th">Mar</th>
<th data-quarto-table-cell-role="th">Apr</th>
<th data-quarto-table-cell-role="th">May</th>
<th data-quarto-table-cell-role="th">Jun</th>
<th data-quarto-table-cell-role="th">Jul</th>
<th data-quarto-table-cell-role="th">Aug</th>
<th data-quarto-table-cell-role="th">Sep</th>
<th data-quarto-table-cell-role="th">Oct</th>
<th data-quarto-table-cell-role="th">Nov</th>
<th data-quarto-table-cell-role="th">Dec</th>
<th data-quarto-table-cell-role="th">J-D</th>
<th data-quarto-table-cell-role="th">D-N</th>
<th data-quarto-table-cell-role="th">DJF</th>
<th data-quarto-table-cell-role="th">MAM</th>
<th data-quarto-table-cell-role="th">JJA</th>
<th data-quarto-table-cell-role="th">SON</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1880</td>
<td>-0.39</td>
<td>-0.54</td>
<td>-0.24</td>
<td>-0.31</td>
<td>-0.05</td>
<td>-0.18</td>
<td>-0.23</td>
<td>-0.27</td>
<td>-0.26</td>
<td>-0.31</td>
<td>-0.46</td>
<td>-0.43</td>
<td>-0.31</td>
<td>NaN</td>
<td>NaN</td>
<td>-0.20</td>
<td>-0.23</td>
<td>-0.34</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1881</td>
<td>-0.31</td>
<td>-0.26</td>
<td>-0.07</td>
<td>-0.03</td>
<td>0.03</td>
<td>-0.34</td>
<td>0.08</td>
<td>-0.06</td>
<td>-0.29</td>
<td>-0.45</td>
<td>-0.38</td>
<td>-0.24</td>
<td>-0.19</td>
<td>-0.21</td>
<td>-0.33</td>
<td>-0.02</td>
<td>-0.11</td>
<td>-0.37</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1882</td>
<td>0.25</td>
<td>0.20</td>
<td>0.01</td>
<td>-0.31</td>
<td>-0.24</td>
<td>-0.29</td>
<td>-0.28</td>
<td>-0.17</td>
<td>-0.26</td>
<td>-0.53</td>
<td>-0.34</td>
<td>-0.69</td>
<td>-0.22</td>
<td>-0.18</td>
<td>0.07</td>
<td>-0.18</td>
<td>-0.25</td>
<td>-0.38</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1883</td>
<td>-0.58</td>
<td>-0.66</td>
<td>-0.15</td>
<td>-0.30</td>
<td>-0.26</td>
<td>-0.11</td>
<td>-0.06</td>
<td>-0.23</td>
<td>-0.34</td>
<td>-0.16</td>
<td>-0.45</td>
<td>-0.15</td>
<td>-0.29</td>
<td>-0.33</td>
<td>-0.64</td>
<td>-0.24</td>
<td>-0.13</td>
<td>-0.32</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1884</td>
<td>-0.17</td>
<td>-0.11</td>
<td>-0.64</td>
<td>-0.59</td>
<td>-0.36</td>
<td>-0.41</td>
<td>-0.41</td>
<td>-0.51</td>
<td>-0.45</td>
<td>-0.45</td>
<td>-0.58</td>
<td>-0.47</td>
<td>-0.43</td>
<td>-0.40</td>
<td>-0.14</td>
<td>-0.53</td>
<td>-0.45</td>
<td>-0.49</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-4" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 145 entries, 0 to 144
Data columns (total 19 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   Year    145 non-null    int64  
 1   Jan     145 non-null    float64
 2   Feb     145 non-null    float64
 3   Mar     145 non-null    float64
 4   Apr     145 non-null    float64
 5   May     145 non-null    float64
 6   Jun     145 non-null    float64
 7   Jul     145 non-null    float64
 8   Aug     145 non-null    float64
 9   Sep     145 non-null    float64
 10  Oct     145 non-null    float64
 11  Nov     144 non-null    float64
 12  Dec     144 non-null    float64
 13  J-D     144 non-null    float64
 14  D-N     143 non-null    float64
 15  DJF     144 non-null    float64
 16  MAM     145 non-null    float64
 17  JJA     145 non-null    float64
 18  SON     144 non-null    float64
dtypes: float64(18), int64(1)
memory usage: 21.6 KB</code></pre>
</div>
</div>
<div id="cell-5" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Python Walkthrough 1.2</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.set_index(<span class="st">"Year"</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>df.head()</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>df.tail()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Jan</th>
<th data-quarto-table-cell-role="th">Feb</th>
<th data-quarto-table-cell-role="th">Mar</th>
<th data-quarto-table-cell-role="th">Apr</th>
<th data-quarto-table-cell-role="th">May</th>
<th data-quarto-table-cell-role="th">Jun</th>
<th data-quarto-table-cell-role="th">Jul</th>
<th data-quarto-table-cell-role="th">Aug</th>
<th data-quarto-table-cell-role="th">Sep</th>
<th data-quarto-table-cell-role="th">Oct</th>
<th data-quarto-table-cell-role="th">Nov</th>
<th data-quarto-table-cell-role="th">Dec</th>
<th data-quarto-table-cell-role="th">J-D</th>
<th data-quarto-table-cell-role="th">D-N</th>
<th data-quarto-table-cell-role="th">DJF</th>
<th data-quarto-table-cell-role="th">MAM</th>
<th data-quarto-table-cell-role="th">JJA</th>
<th data-quarto-table-cell-role="th">SON</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2020</td>
<td>1.59</td>
<td>1.70</td>
<td>1.67</td>
<td>1.40</td>
<td>1.27</td>
<td>1.14</td>
<td>1.10</td>
<td>1.12</td>
<td>1.19</td>
<td>1.21</td>
<td>1.59</td>
<td>1.19</td>
<td>1.35</td>
<td>1.36</td>
<td>1.56</td>
<td>1.44</td>
<td>1.12</td>
<td>1.33</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021</td>
<td>1.25</td>
<td>0.96</td>
<td>1.21</td>
<td>1.13</td>
<td>1.05</td>
<td>1.21</td>
<td>1.07</td>
<td>1.03</td>
<td>1.05</td>
<td>1.30</td>
<td>1.29</td>
<td>1.17</td>
<td>1.14</td>
<td>1.14</td>
<td>1.13</td>
<td>1.13</td>
<td>1.10</td>
<td>1.21</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022</td>
<td>1.25</td>
<td>1.17</td>
<td>1.41</td>
<td>1.09</td>
<td>1.02</td>
<td>1.13</td>
<td>1.06</td>
<td>1.17</td>
<td>1.15</td>
<td>1.31</td>
<td>1.10</td>
<td>1.06</td>
<td>1.16</td>
<td>1.17</td>
<td>1.19</td>
<td>1.17</td>
<td>1.12</td>
<td>1.19</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2023</td>
<td>1.30</td>
<td>1.30</td>
<td>1.64</td>
<td>1.02</td>
<td>1.13</td>
<td>1.19</td>
<td>1.45</td>
<td>1.57</td>
<td>1.67</td>
<td>1.88</td>
<td>1.98</td>
<td>1.85</td>
<td>1.50</td>
<td>1.43</td>
<td>1.22</td>
<td>1.26</td>
<td>1.40</td>
<td>1.84</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2024</td>
<td>1.68</td>
<td>1.93</td>
<td>1.78</td>
<td>1.80</td>
<td>1.45</td>
<td>1.54</td>
<td>1.42</td>
<td>1.42</td>
<td>1.58</td>
<td>1.72</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.82</td>
<td>1.67</td>
<td>1.46</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-6" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"Jan"</span>].plot(ax<span class="op">=</span>ax)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"y label"</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"x label"</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"title"</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="practice_files/figure-html/labs-Practice-Empirical-cell-8-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-7" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>ax.plot(df.index, df[<span class="st">"Jan"</span>])</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"y label"</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"x label"</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"title"</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="practice_files/figure-html/labs-Practice-Empirical-cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-8" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>month <span class="op">=</span> <span class="st">"Jan"</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>ax.axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">"orange"</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>ax.annotate(<span class="st">"1951—1980 average"</span>, xy<span class="op">=</span>(<span class="fl">0.66</span>, <span class="op">-</span><span class="fl">0.2</span>), xycoords<span class="op">=</span>(<span class="st">"figure fraction"</span>, <span class="st">"data"</span>))</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>df[month].plot(ax<span class="op">=</span>ax)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>ax.set_title(</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"Average temperature anomaly in </span><span class="sc">{</span>month<span class="sc">}</span><span class="ss"> </span><span class="ch">\n</span><span class="ss"> in the northern hemisphere (1880—</span><span class="sc">{</span>df<span class="sc">.</span>index<span class="sc">.</span><span class="bu">max</span>()<span class="sc">}</span><span class="ss">)"</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Annual temperature anomalies"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>Text(0, 0.5, 'Annual temperature anomalies')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="practice_files/figure-html/labs-Practice-Empirical-cell-10-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-9" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Python Walkthrough 1.3</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>month <span class="op">=</span> <span class="st">"J-D"</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>ax.axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">"orange"</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>ax.annotate(<span class="st">"1951—1980 average"</span>, xy<span class="op">=</span>(<span class="fl">0.68</span>, <span class="op">-</span><span class="fl">0.2</span>), xycoords<span class="op">=</span>(<span class="st">"figure fraction"</span>, <span class="st">"data"</span>))</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>df[month].plot(ax<span class="op">=</span>ax)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>ax.set_title(</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"Average annual temperature anomaly in </span><span class="ch">\n</span><span class="ss"> in the northern hemisphere (1880—</span><span class="sc">{</span>df<span class="sc">.</span>index<span class="sc">.</span><span class="bu">max</span>()<span class="sc">}</span><span class="ss">)"</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Annual temperature anomalies"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>Text(0, 0.5, 'Annual temperature anomalies')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="practice_files/figure-html/labs-Practice-Empirical-cell-11-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-10" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Python Walkthrough 1.4</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"Period"</span>] <span class="op">=</span> pd.cut(</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    df.index,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span>[<span class="dv">1921</span>, <span class="dv">1950</span>, <span class="dv">1980</span>, <span class="dv">2010</span>],</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    labels<span class="op">=</span>[<span class="st">"1921—1950"</span>, <span class="st">"1951—1980"</span>, <span class="st">"1981—2010"</span>],</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    ordered<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-11" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"Period"</span>].tail(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>Year
2005    1981—2010
2006    1981—2010
2007    1981—2010
2008    1981—2010
2009    1981—2010
2010    1981—2010
2011          NaN
2012          NaN
2013          NaN
2014          NaN
2015          NaN
2016          NaN
2017          NaN
2018          NaN
2019          NaN
2020          NaN
2021          NaN
2022          NaN
2023          NaN
2024          NaN
Name: Period, dtype: category
Categories (3, object): ['1921—1950' &lt; '1951—1980' &lt; '1981—2010']</code></pre>
</div>
</div>
<div id="cell-12" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>list_of_months <span class="op">=</span> [<span class="st">"Jun"</span>, <span class="st">"Jul"</span>, <span class="st">"Aug"</span>]</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>df[list_of_months].stack().head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>Year     
1880  Jun   -0.18
      Jul   -0.23
      Aug   -0.27
1881  Jun   -0.34
      Jul    0.08
dtype: float64</code></pre>
</div>
</div>
<div id="cell-13" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">9</span>, <span class="dv">4</span>), sharex<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax, period <span class="kw">in</span> <span class="bu">zip</span>(axes, df[<span class="st">"Period"</span>].dropna().unique()):</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    df.loc[df[<span class="st">"Period"</span>] <span class="op">==</span> period, list_of_months].stack().hist(ax<span class="op">=</span>ax)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    ax.set_title(period)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">"Histogram of temperature anomalies"</span>)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">"Summer temperature distribution"</span>)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="practice_files/figure-html/labs-Practice-Empirical-cell-15-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-14" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Python Walkthrough 1.5</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a variable that has years 1951 to 1980, and months Jan to Dec (inclusive)</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>temp_all_months <span class="op">=</span> df.loc[(df.index <span class="op">&gt;=</span> <span class="dv">1951</span>) <span class="op">&amp;</span> (df.index <span class="op">&lt;=</span> <span class="dv">1980</span>), <span class="st">"Jan"</span>:<span class="st">"Dec"</span>]</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Put all the data in stacked format and give the new columns sensible names</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>temp_all_months <span class="op">=</span> (</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    temp_all_months.stack()</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">"level_1"</span>: <span class="st">"month"</span>, <span class="dv">0</span>: <span class="st">"values"</span>})</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Take a look at this data:</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>temp_all_months</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1951</td>
<td>Jan</td>
<td>-0.36</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1951</td>
<td>Feb</td>
<td>-0.51</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1951</td>
<td>Mar</td>
<td>-0.18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1951</td>
<td>Apr</td>
<td>0.06</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1951</td>
<td>May</td>
<td>0.17</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">355</td>
<td>1980</td>
<td>Aug</td>
<td>0.10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">356</td>
<td>1980</td>
<td>Sep</td>
<td>0.10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">357</td>
<td>1980</td>
<td>Oct</td>
<td>0.12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">358</td>
<td>1980</td>
<td>Nov</td>
<td>0.21</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">359</td>
<td>1980</td>
<td>Dec</td>
<td>0.09</td>
</tr>
</tbody>
</table>

<p>360 rows × 3 columns</p>
</div>
</div>
</div>
<div id="cell-15" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>quantiles <span class="op">=</span> [<span class="fl">0.3</span>, <span class="fl">0.7</span>]</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>list_of_percentiles <span class="op">=</span> np.quantile(temp_all_months[<span class="st">"values"</span>], q<span class="op">=</span>quantiles)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The cold threshold of </span><span class="sc">{</span>quantiles[<span class="dv">0</span>]<span class="op">*</span><span class="dv">100</span><span class="sc">}</span><span class="ss">% is </span><span class="sc">{</span>list_of_percentiles[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The hot threshold of </span><span class="sc">{</span>quantiles[<span class="dv">1</span>]<span class="op">*</span><span class="dv">100</span><span class="sc">}</span><span class="ss">% is </span><span class="sc">{</span>list_of_percentiles[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The cold threshold of 30.0% is -0.1
The hot threshold of 70.0% is 0.1</code></pre>
</div>
</div>
<div id="cell-16" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Python Walkthrough 1.6</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a variable that has years 1981 to 2010, and months Jan to Dec (inclusive)</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>temp_all_months <span class="op">=</span> df.loc[(df.index <span class="op">&gt;=</span> <span class="dv">1981</span>) <span class="op">&amp;</span> (df.index <span class="op">&lt;=</span> <span class="dv">2010</span>), <span class="st">"Jan"</span>:<span class="st">"Dec"</span>]</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Put all the data in stacked format and give the new columns sensible names</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>temp_all_months <span class="op">=</span> (</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    temp_all_months.stack()</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">"level_1"</span>: <span class="st">"month"</span>, <span class="dv">0</span>: <span class="st">"values"</span>})</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Take a look at the start of this data data:</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>temp_all_months.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1981</td>
<td>Jan</td>
<td>0.80</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1981</td>
<td>Feb</td>
<td>0.62</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1981</td>
<td>Mar</td>
<td>0.68</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1981</td>
<td>Apr</td>
<td>0.39</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1981</td>
<td>May</td>
<td>0.18</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-17" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>entries_less_than_q30 <span class="op">=</span> temp_all_months[<span class="st">"values"</span>] <span class="op">&lt;</span> list_of_percentiles[<span class="dv">0</span>]</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>proportion_under_q30 <span class="op">=</span> entries_less_than_q30.mean()</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"The proportion under </span><span class="sc">{</span>list_of_percentiles[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> is </span><span class="sc">{</span>proportion_under_q30<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%"</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The proportion under -0.1 is 1.94%</code></pre>
</div>
</div>
<div id="cell-18" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>proportion_over_q70 <span class="op">=</span> (temp_all_months[<span class="st">"values"</span>] <span class="op">&gt;</span> list_of_percentiles[<span class="dv">1</span>]).mean()</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The proportion over </span><span class="sc">{</span>list_of_percentiles[<span class="dv">1</span>]<span class="sc">}</span><span class="ss"> is </span><span class="sc">{</span>proportion_over_q70<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The proportion over 0.1 is 84.72%</code></pre>
</div>
</div>
<div id="cell-19" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Python Walkthrough 1.7</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>temp_all_months <span class="op">=</span> (</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    df.loc[:, <span class="st">"DJF"</span>:<span class="st">"SON"</span>]</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    .stack()</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">"level_1"</span>: <span class="st">"season"</span>, <span class="dv">0</span>: <span class="st">"values"</span>})</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>temp_all_months[<span class="st">"Period"</span>] <span class="op">=</span> pd.cut(</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    temp_all_months[<span class="st">"Year"</span>],</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span>[<span class="dv">1921</span>, <span class="dv">1950</span>, <span class="dv">1980</span>, <span class="dv">2010</span>],</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>    labels<span class="op">=</span>[<span class="st">"1921—1950"</span>, <span class="st">"1951—1980"</span>, <span class="st">"1981—2010"</span>],</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>    ordered<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Take a look at a cut of the data using `.iloc`, which provides position</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>temp_all_months.iloc[<span class="op">-</span><span class="dv">135</span>:<span class="op">-</span><span class="dv">125</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">values</th>
<th data-quarto-table-cell-role="th">Period</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">443</td>
<td>1991</td>
<td>DJF</td>
<td>0.51</td>
<td>1981—2010</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">444</td>
<td>1991</td>
<td>MAM</td>
<td>0.45</td>
<td>1981—2010</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">445</td>
<td>1991</td>
<td>JJA</td>
<td>0.42</td>
<td>1981—2010</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">446</td>
<td>1991</td>
<td>SON</td>
<td>0.32</td>
<td>1981—2010</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">447</td>
<td>1992</td>
<td>DJF</td>
<td>0.44</td>
<td>1981—2010</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">448</td>
<td>1992</td>
<td>MAM</td>
<td>0.30</td>
<td>1981—2010</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">449</td>
<td>1992</td>
<td>JJA</td>
<td>-0.04</td>
<td>1981—2010</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">450</td>
<td>1992</td>
<td>SON</td>
<td>-0.15</td>
<td>1981—2010</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">451</td>
<td>1993</td>
<td>DJF</td>
<td>0.37</td>
<td>1981—2010</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">452</td>
<td>1993</td>
<td>MAM</td>
<td>0.31</td>
<td>1981—2010</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-20" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>grp_mean_var <span class="op">=</span> temp_all_months.groupby([<span class="st">"season"</span>, <span class="st">"Period"</span>])[<span class="st">"values"</span>].agg(</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>    [np.mean, np.var]</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>grp_mean_var</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">var</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">Period</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">DJF</td>
<td data-quarto-table-cell-role="th">1921—1950</td>
<td>-0.026207</td>
<td>0.057303</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1951—1980</td>
<td>-0.002333</td>
<td>0.050494</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1981—2010</td>
<td>0.524333</td>
<td>0.079646</td>
</tr>
<tr class="even">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">JJA</td>
<td data-quarto-table-cell-role="th">1921—1950</td>
<td>-0.052414</td>
<td>0.021290</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1951—1980</td>
<td>-0.000333</td>
<td>0.014631</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1981—2010</td>
<td>0.400333</td>
<td>0.067727</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">MAM</td>
<td data-quarto-table-cell-role="th">1921—1950</td>
<td>-0.041724</td>
<td>0.031236</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1951—1980</td>
<td>0.000333</td>
<td>0.025245</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1981—2010</td>
<td>0.510333</td>
<td>0.076238</td>
</tr>
<tr class="even">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">SON</td>
<td data-quarto-table-cell-role="th">1921—1950</td>
<td>0.083103</td>
<td>0.027751</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1951—1980</td>
<td>-0.001000</td>
<td>0.026258</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1981—2010</td>
<td>0.429333</td>
<td>0.111731</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-21" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>min_year <span class="op">=</span> <span class="dv">1880</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>    ggplot(temp_all_months, aes(x<span class="op">=</span><span class="st">"Year"</span>, y<span class="op">=</span><span class="st">"values"</span>, color<span class="op">=</span><span class="st">"season"</span>))</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> geom_abline(slope<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">"black"</span>, size<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> geom_line(size<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> labs(</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="ss">f"Average annual temperature anomaly in </span><span class="ch">\n</span><span class="ss"> in the northern hemisphere (</span><span class="sc">{</span>min_year<span class="sc">}</span><span class="ss">—</span><span class="sc">{</span>temp_all_months[<span class="st">'Year'</span>]<span class="sc">.</span><span class="bu">max</span>()<span class="sc">}</span><span class="ss">)"</span>,</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">"Annual temperature anomalies"</span>,</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> scale_x_continuous(<span class="bu">format</span><span class="op">=</span><span class="st">"d"</span>)</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> geom_text(</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>min_year, y<span class="op">=</span><span class="fl">0.1</span>, label<span class="op">=</span><span class="st">"1951—1980 average"</span>, hjust<span class="op">=</span><span class="st">"left"</span>, color<span class="op">=</span><span class="st">"black"</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" display="block" class="plt-container" width="600.0" height="400.0">
  <style type="text/css">
  .plt-container {
   font-family: Lucida Grande, sans-serif;
   user-select: none;
   -webkit-user-select: none;
   -moz-user-select: none;
   -ms-user-select: none;
}
text {
   text-rendering: optimizeLegibility;
}
#prVIWgo .plot-title {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 16.0px;

}
#prVIWgo .plot-subtitle {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 15.0px;

}
#prVIWgo .plot-caption {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#prVIWgo .hyperlink-element {
fill: #118ed8;
font-weight: normal;
   font-style: normal;
}
#prVIWgo .legend-title {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 15.0px;

}
#prVIWgo .legend-item {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#prVIWgo .axis-title-x {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 15.0px;

}
#prVIWgo .axis-text-x {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#dXvMHfO .axis-tooltip-text-x {
fill: #ffffff;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#prVIWgo .axis-title-y {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 15.0px;

}
#prVIWgo .axis-text-y {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#dXvMHfO .axis-tooltip-text-y {
fill: #ffffff;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#prVIWgo .facet-strip-text-x {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#prVIWgo .facet-strip-text-y {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#dXvMHfO .tooltip-text {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#dXvMHfO .tooltip-title {
fill: #474747;
font-weight: bold;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#dXvMHfO .tooltip-label {
fill: #474747;
font-weight: bold;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}

  </style>
  <g id="prVIWgo">
    <path fill-rule="evenodd" fill="rgb(255,255,255)" fill-opacity="1.0" d="M0.0 0.0 L0.0 400.0 L600.0 400.0 L600.0 0.0 Z">
    </path>
    <g transform="translate(29.5 42.5 ) ">
      <g>
        <g transform="translate(35.01530667574961 0.0 ) ">
          <g>
            <line x1="20.292512015615102" y1="0.0" x2="20.292512015615102" y2="305.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="76.66060094787917" y1="0.0" x2="76.66060094787917" y2="305.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="133.02868988014325" y1="0.0" x2="133.02868988014325" y2="305.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="189.39677881240732" y1="0.0" x2="189.39677881240732" y2="305.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="245.7648677446714" y1="0.0" x2="245.7648677446714" y2="305.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="302.13295667693546" y1="0.0" x2="302.13295667693546" y2="305.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="358.50104560919954" y1="0.0" x2="358.50104560919954" y2="305.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="414.8691345414636" y1="0.0" x2="414.8691345414636" y2="305.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
          </g>
        </g>
        <g transform="translate(35.01530667574961 0.0 ) ">
          <g>
            <line x1="0.0" y1="288.2380424453595" x2="446.4352643435323" y2="288.2380424453595" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="0.0" y1="239.93268926195756" x2="446.4352643435323" y2="239.93268926195756" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="0.0" y1="191.6273360785556" x2="446.4352643435323" y2="191.6273360785556" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="0.0" y1="143.32198289515364" x2="446.4352643435323" y2="143.32198289515364" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="0.0" y1="95.01662971175168" x2="446.4352643435323" y2="95.01662971175168" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="0.0" y1="46.711276528349714" x2="446.4352643435323" y2="46.711276528349714" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
          </g>
        </g>
      </g>
      <g clip-path="url(#ced4zan)" clip-bounds-jfx="[rect (35.01530667574961, 0.0), (446.4352643435323, 305.0)]">
        <g transform="translate(35.01530667574961 0.0 ) ">
          <g>
            <g>
              <line x1="0.0" y1="191.6273360785556" x2="446.43526434353225" y2="191.62733607855557" stroke="rgb(0,0,0)" stroke-opacity="1.0" fill="none" stroke-width="2.2">
              </line>
            </g>
            <g>
              <g>
                <path d="M20.292512015615102 210.94947735191639 L20.292512015615102 210.94947735191639 L23.110916462228488 193.55955020589167 L25.929320908841873 209.01726322458032 L28.74772535545435 214.81390560658855 L31.566129802067735 242.8310104529617 L34.38453424868112 234.13604687994933 L37.202938695294506 237.03436807095343 L40.02134314190789 226.407190370605 L42.83974758852037 223.5088691796009 L45.65815203513375 187.76290782388344 L48.47655648174714 226.407190370605 L51.294960928360524 212.88169147925245 L54.11336537497391 234.13604687994933 L56.931769821586386 225.44108330693697 L59.75017426819977 223.5088691796009 L62.56857871481316 222.54276211593285 L65.38698316142654 232.20383275261324 L68.20538760803993 201.288406715236 L71.0237920546524 236.0682610072854 L73.84219650126579 225.44108330693697 L76.66060094787917 193.55955020589167 L79.47900539449256 182.93237250554324 L82.29740984110595 228.33940449794108 L85.11581428771842 226.407190370605 L87.93421873433181 237.03436807095343 L90.75262318094519 222.54276211593285 L93.57102762755858 205.15283496990816 L96.38943207417196 235.10215394361737 L99.20783652078444 238.96658219828953 L102.02624096739783 249.59375989863796 L104.84464541401121 230.27161862527717 L107.6630498606246 240.8987963256256 L110.48145430723798 219.64444092492874 L113.29985875385046 239.93268926195756 L116.11826320046384 221.5766550522648 L118.93666764707723 197.42397846056383 L121.75507209369061 227.37329743427307 L124.573476540304 260.2209375989864 L127.39188098691648 234.13604687994933 L130.21028543352986 225.44108330693697 L133.02868988014325 205.15283496990816 L135.84709432675663 209.01726322458032 L138.66549877337002 206.1189420335762 L141.4839032199825 234.13604687994933 L144.30230766659588 200.32229965156796 L147.12071211320927 209.98337028824835 L149.93911655982265 190.66122901488757 L152.75752100643604 219.64444092492874 L155.5759254530485 214.81390560658855 L158.3943298996619 216.74611973392462 L161.21273434627528 198.39008552423186 L164.03113879288867 203.22062084257206 L166.84954323950205 197.42397846056383 L169.66794768611544 213.84779854292051 L172.48635213272792 206.1189420335762 L175.3047565793413 210.94947735191639 L178.1231610259547 196.4578713968958 L180.94156547256807 197.42397846056383 L183.75996991918146 169.4068736141907 L186.57837436579393 201.288406715236 L189.39677881240732 176.16962305986698 L192.2151832590207 176.16962305986698 L195.0335877056341 182.93237250554324 L197.85199215224748 174.23740893253088 L200.67039659885995 167.47465948685462 L203.48880104547334 176.16962305986698 L206.30720549208672 176.16962305986698 L209.1256099387001 173.27130186886285 L211.9440143853135 195.49176433322776 L214.76241883192597 190.66122901488757 L217.58082327853936 198.39008552423186 L220.39922772515274 189.69512195121953 L223.21763217176613 188.72901488755147 L226.0360366183795 162.64412416851442 L228.854441064992 199.35619258789993 L231.67284551160537 217.71222679759268 L234.49124995821876 216.74611973392462 L237.30965440483214 199.35619258789993 L240.12805885144553 181.9662654418752 L242.946463298058 172.30519480519482 L245.7648677446714 207.08504909724422 L248.58327219128478 178.10183718720305 L251.40167663789816 174.23740893253088 L254.22008108451155 195.49176433322776 L257.038485531124 214.81390560658855 L259.8568899777374 207.08504909724422 L262.6752944243508 200.32229965156796 L265.4936988709642 176.16962305986698 L268.31210331757757 180.03405131453914 L271.13050776419004 193.55955020589167 L273.9489122108034 194.52565726955973 L276.7673166574168 210.94947735191639 L279.5857211040302 200.32229965156796 L282.4041255506436 172.30519480519482 L285.22252999725606 200.32229965156796 L288.04093444386945 186.7968007602154 L290.85933889048283 209.01726322458032 L293.6777433370962 167.47465948685462 L296.4961477837096 183.89847956921128 L299.314552230323 190.66122901488757 L302.13295667693546 176.16962305986698 L304.95136112354885 151.05083940449796 L307.76976557016224 181.00015837820717 L310.5881700167756 174.23740893253088 L313.406574463389 181.00015837820717 L316.2249789100015 189.69512195121953 L319.04338335661487 172.30519480519482 L321.86178780322825 181.9662654418752 L324.68019224984164 148.15251821349383 L327.498596696455 159.7458029775103 L330.3170011430675 115.3048780487805 L333.1354055896809 148.15251821349383 L335.95381003629427 162.64412416851442 L338.77221448290766 161.6780171048464 L341.59061892952104 147.1864111498258 L344.4090233761335 136.55923344947738 L347.2274278227469 164.5763382958505 L350.0458322693603 138.49144757681344 L352.8642367159737 119.16930630345266 L355.68264116258706 152.98305353183403 L358.50104560919954 118.20319923978462 L361.3194500558129 125.93205574912892 L364.1378545024263 122.06762749445677 L366.9562589490397 127.86426987646502 L369.7746633956531 123.99984162179285 L372.59306784226555 106.60991447576815 L375.41147228887894 123.03373455812482 L378.2298767354923 103.71159328476402 L381.0482811821057 114.33877098511246 L383.8666856287191 128.83037694013305 L386.6850900753316 89.21998732974343 L389.50349452194496 115.3048780487805 L392.32189896855834 103.71159328476402 L395.14030341517173 118.20319923978462 L397.9587078617851 88.2538802660754 L400.7771123083976 82.45723788406718 L403.595516755011 47.67738359201775 L406.41392120162436 74.72838137472286 L409.23232564823775 90.18609439341148 L412.05073009485113 68.93173899271461 L414.8691345414636 52.507918910357944 L417.687538988077 82.45723788406718 L420.5059434346904 78.59280962939502 L423.32434788130377 69.89784605638266 L426.14275232791715 30.287456445993058 " fill="none" stroke-width="2.2" stroke="rgb(228,26,28)" stroke-opacity="1.0">
                </path>
              </g>
              <g>
                <path d="M20.292512015615102 213.84779854292051 L20.292512015615102 213.84779854292051 L23.110916462228488 202.25451377890403 L25.929320908841873 215.78001267025658 L28.74772535545435 204.18672790624012 L31.566129802067735 235.10215394361737 L34.38453424868112 230.27161862527717 L37.202938695294506 221.5766550522648 L40.02134314190789 223.5088691796009 L42.83974758852037 199.35619258789993 L45.65815203513375 203.22062084257206 L48.47655648174714 216.74611973392462 L51.294960928360524 202.25451377890403 L54.11336537497391 215.78001267025658 L56.931769821586386 211.91558441558442 L59.75017426819977 219.64444092492874 L62.56857871481316 212.88169147925245 L65.38698316142654 192.59344314222363 L68.20538760803993 194.52565726955973 L71.0237920546524 204.18672790624012 L73.84219650126579 209.98337028824835 L76.66060094787917 200.32229965156796 L79.47900539449256 195.49176433322776 L82.29740984110595 224.47497624326894 L85.11581428771842 238.00047513462147 L87.93421873433181 243.79711751662973 L90.75262318094519 214.81390560658855 L93.57102762755858 209.01726322458032 L96.38943207417196 233.16993981628127 L99.20783652078444 230.27161862527717 L102.02624096739783 234.13604687994933 L104.84464541401121 230.27161862527717 L107.6630498606246 229.30551156160914 L110.48145430723798 238.00047513462147 L113.29985875385046 238.96658219828953 L116.11826320046384 218.6783338612607 L118.93666764707723 204.18672790624012 L121.75507209369061 231.2377256889452 L124.573476540304 231.2377256889452 L127.39188098691648 229.30551156160914 L130.21028543352986 224.47497624326894 L133.02868988014325 217.71222679759268 L135.84709432675663 207.08504909724422 L138.66549877337002 216.74611973392462 L141.4839032199825 217.71222679759268 L144.30230766659588 212.88169147925245 L147.12071211320927 214.81390560658855 L149.93911655982265 206.1189420335762 L152.75752100643604 203.22062084257206 L155.5759254530485 211.91558441558442 L158.3943298996619 221.5766550522648 L161.21273434627528 195.49176433322776 L164.03113879288867 180.03405131453914 L166.84954323950205 202.25451377890403 L169.66794768611544 209.98337028824835 L172.48635213272792 195.49176433322776 L175.3047565793413 199.35619258789993 L178.1231610259547 186.7968007602154 L180.94156547256807 177.135730123535 L183.75996991918146 191.6273360785556 L186.57837436579393 186.7968007602154 L189.39677881240732 179.06794425087108 L192.2151832590207 170.37298067785875 L195.0335877056341 190.66122901488757 L197.85199215224748 190.66122901488757 L200.67039659885995 176.16962305986698 L203.48880104547334 178.10183718720305 L206.30720549208672 197.42397846056383 L209.1256099387001 193.55955020589167 L211.9440143853135 188.72901488755147 L214.76241883192597 203.22062084257206 L217.58082327853936 206.1189420335762 L220.39922772515274 182.93237250554324 L223.21763217176613 180.03405131453914 L226.0360366183795 170.37298067785875 L228.854441064992 196.4578713968958 L231.67284551160537 194.52565726955973 L234.49124995821876 213.84779854292051 L237.30965440483214 179.06794425087108 L240.12805885144553 184.86458663287934 L242.946463298058 182.93237250554324 L245.7648677446714 179.06794425087108 L248.58327219128478 182.93237250554324 L251.40167663789816 191.6273360785556 L254.22008108451155 184.86458663287934 L257.038485531124 206.1189420335762 L259.8568899777374 210.94947735191639 L262.6752944243508 181.9662654418752 L265.4936988709642 189.69512195121953 L268.31210331757757 198.39008552423186 L271.13050776419004 189.69512195121953 L273.9489122108034 194.52565726955973 L276.7673166574168 205.15283496990816 L279.5857211040302 199.35619258789993 L282.4041255506436 183.89847956921128 L285.22252999725606 205.15283496990816 L288.04093444386945 200.32229965156796 L290.85933889048283 212.88169147925245 L293.6777433370962 181.00015837820717 L296.4961477837096 203.22062084257206 L299.314552230323 185.83069369654737 L302.13295667693546 178.10183718720305 L304.95136112354885 174.23740893253088 L307.76976557016224 191.6273360785556 L310.5881700167756 173.27130186886285 L313.406574463389 183.89847956921128 L316.2249789100015 194.52565726955973 L319.04338335661487 186.7968007602154 L321.86178780322825 169.4068736141907 L324.68019224984164 156.8474817865062 L327.498596696455 165.54244535951852 L330.3170011430675 152.98305353183403 L333.1354055896809 151.05083940449796 L335.95381003629427 195.49176433322776 L338.77221448290766 180.03405131453914 L341.59061892952104 156.8474817865062 L344.4090233761335 146.22030408615777 L347.2274278227469 168.44076655052265 L350.0458322693603 147.1864111498258 L352.8642367159737 121.10152043078874 L355.68264116258706 158.77969591384226 L358.50104560919954 149.11862527716187 L361.3194500558129 132.6948051948052 L364.1378545024263 130.76259106746915 L366.9562589490397 123.99984162179285 L369.7746633956531 142.3558758314856 L372.59306784226555 120.13541336712069 L375.41147228887894 121.10152043078874 L378.2298767354923 126.89816281279697 L381.0482811821057 133.66091225847325 L383.8666856287191 124.9659486854609 L386.6850900753316 108.54212860310423 L389.50349452194496 121.10152043078874 L392.32189896855834 109.50823566677226 L395.14030341517173 120.13541336712069 L397.9587078617851 111.44044979410835 L400.7771123083976 95.01662971175168 L403.595516755011 85.35555907507127 L406.41392120162436 96.94884383908776 L409.23232564823775 104.67770034843207 L412.05073009485113 84.38945201140324 L414.8691345414636 83.42334494773519 L417.687538988077 85.35555907507127 L420.5059434346904 83.42334494773519 L423.32434788130377 56.37234716503011 L426.14275232791715 50.57570478302188 " fill="none" stroke-width="2.2" stroke="rgb(55,126,184)" stroke-opacity="1.0">
                </path>
              </g>
              <g>
                <path d="M20.292512015615102 224.47497624326894 L20.292512015615102 224.47497624326894 L23.110916462228488 227.37329743427307 L25.929320908841873 228.33940449794108 L28.74772535545435 222.54276211593285 L31.566129802067735 238.96658219828953 L34.38453424868112 228.33940449794108 L37.202938695294506 225.44108330693697 L40.02134314190789 222.54276211593285 L42.83974758852037 199.35619258789993 L45.65815203513375 234.13604687994933 L48.47655648174714 226.407190370605 L51.294960928360524 218.6783338612607 L54.11336537497391 233.16993981628127 L56.931769821586386 220.61054798859678 L59.75017426819977 226.407190370605 L62.56857871481316 200.32229965156796 L65.38698316142654 200.32229965156796 L68.20538760803993 207.08504909724422 L71.0237920546524 225.44108330693697 L73.84219650126579 180.03405131453914 L76.66060094787917 188.72901488755147 L79.47900539449256 216.74611973392462 L82.29740984110595 227.37329743427307 L85.11581428771842 235.10215394361737 L87.93421873433181 227.37329743427307 L90.75262318094519 204.18672790624012 L93.57102762755858 217.71222679759268 L96.38943207417196 229.30551156160914 L99.20783652078444 236.0682610072854 L102.02624096739783 218.6783338612607 L104.84464541401121 235.10215394361737 L107.6630498606246 216.74611973392462 L110.48145430723798 261.18704466265444 L113.29985875385046 222.54276211593285 L116.11826320046384 208.05115616091229 L118.93666764707723 208.05115616091229 L121.75507209369061 234.13604687994933 L124.573476540304 232.20383275261324 L127.39188098691648 209.01726322458032 L130.21028543352986 215.78001267025658 L133.02868988014325 230.27161862527717 L135.84709432675663 201.288406715236 L138.66549877337002 218.6783338612607 L141.4839032199825 189.69512195121953 L144.30230766659588 202.25451377890403 L147.12071211320927 188.72901488755147 L149.93911655982265 184.86458663287934 L152.75752100643604 179.06794425087108 L155.5759254530485 198.39008552423186 L158.3943298996619 199.35619258789993 L161.21273434627528 176.16962305986698 L164.03113879288867 164.5763382958505 L166.84954323950205 192.59344314222363 L169.66794768611544 212.88169147925245 L172.48635213272792 182.93237250554324 L175.3047565793413 199.35619258789993 L178.1231610259547 181.9662654418752 L180.94156547256807 163.61023123218246 L183.75996991918146 166.5085524231866 L186.57837436579393 177.135730123535 L189.39677881240732 164.5763382958505 L192.2151832590207 166.5085524231866 L195.0335877056341 170.37298067785875 L197.85199215224748 160.71191004117836 L200.67039659885995 159.7458029775103 L203.48880104547334 174.23740893253088 L206.30720549208672 189.69512195121953 L209.1256099387001 173.27130186886285 L211.9440143853135 188.72901488755147 L214.76241883192597 190.66122901488757 L217.58082327853936 207.08504909724422 L220.39922772515274 169.4068736141907 L223.21763217176613 194.52565726955973 L226.0360366183795 174.23740893253088 L228.854441064992 173.27130186886285 L231.67284551160537 199.35619258789993 L234.49124995821876 219.64444092492874 L237.30965440483214 181.9662654418752 L240.12805885144553 185.83069369654737 L242.946463298058 187.76290782388344 L245.7648677446714 188.72901488755147 L248.58327219128478 191.6273360785556 L251.40167663789816 183.89847956921128 L254.22008108451155 159.7458029775103 L257.038485531124 217.71222679759268 L259.8568899777374 197.42397846056383 L262.6752944243508 192.59344314222363 L265.4936988709642 181.9662654418752 L268.31210331757757 200.32229965156796 L271.13050776419004 184.86458663287934 L273.9489122108034 199.35619258789993 L276.7673166574168 202.25451377890403 L279.5857211040302 208.05115616091229 L282.4041255506436 200.32229965156796 L285.22252999725606 210.94947735191639 L288.04093444386945 209.01726322458032 L290.85933889048283 222.54276211593285 L293.6777433370962 179.06794425087108 L296.4961477837096 186.7968007602154 L299.314552230323 170.37298067785875 L302.13295667693546 178.10183718720305 L304.95136112354885 168.44076655052265 L307.76976557016224 193.55955020589167 L310.5881700167756 163.61023123218246 L313.406574463389 193.55955020589167 L316.2249789100015 189.69512195121953 L319.04338335661487 188.72901488755147 L321.86178780322825 168.44076655052265 L324.68019224984164 174.23740893253088 L327.498596696455 172.30519480519482 L330.3170011430675 148.15251821349383 L333.1354055896809 160.71191004117836 L335.95381003629427 206.1189420335762 L338.77221448290766 196.4578713968958 L341.59061892952104 147.1864111498258 L344.4090233761335 140.4236617041495 L347.2274278227469 177.135730123535 L350.0458322693603 135.59312638580934 L352.8642367159737 138.49144757681344 L355.68264116258706 149.11862527716187 L358.50104560919954 163.61023123218246 L361.3194500558129 123.03373455812482 L364.1378545024263 128.83037694013305 L366.9562589490397 113.37266392144441 L369.7746633956531 118.20319923978462 L372.59306784226555 97.91495090275579 L375.41147228887894 103.71159328476402 L378.2298767354923 117.23709217611658 L381.0482811821057 114.33877098511246 L383.8666856287191 111.44044979410835 L386.6850900753316 100.81327209375992 L389.50349452194496 117.23709217611658 L392.32189896855834 102.74548622109599 L395.14030341517173 105.6438074121001 L397.9587078617851 108.54212860310423 L400.7771123083976 67.96563192904658 L403.595516755011 82.45723788406718 L406.41392120162436 86.32166613873932 L409.23232564823775 89.21998732974343 L412.05073009485113 72.79616724738678 L414.8691345414636 63.13509661070637 L417.687538988077 74.72838137472286 L420.5059434346904 76.66059550205894 L423.32434788130377 13.863636363636374 " fill="none" stroke-width="2.2" stroke="rgb(77,175,74)" stroke-opacity="1.0">
                </path>
              </g>
              <g>
                <path d="M23.110916462228488 223.5088691796009 L23.110916462228488 223.5088691796009 L25.929320908841873 184.86458663287934 L28.74772535545435 253.45818815331012 L31.566129802067735 205.15283496990816 L34.38453424868112 253.45818815331012 L37.202938695294506 246.69543870763383 L40.02134314190789 255.39040228064619 L42.83974758852037 239.93268926195756 L45.65815203513375 198.39008552423186 L48.47655648174714 247.66154577130186 L51.294960928360524 242.8310104529617 L54.11336537497391 212.88169147925245 L56.931769821586386 291.1363636363636 L59.75017426819977 253.45818815331012 L62.56857871481316 250.559866962306 L65.38698316142654 215.78001267025658 L68.20538760803993 224.47497624326894 L71.0237920546524 213.84779854292051 L73.84219650126579 224.47497624326894 L76.66060094787917 230.27161862527717 L79.47900539449256 206.1189420335762 L82.29740984110595 209.01726322458032 L85.11581428771842 214.81390560658855 L87.93421873433181 253.45818815331012 L90.75262318094519 241.86490338929366 L93.57102762755858 232.20383275261324 L96.38943207417196 233.16993981628127 L99.20783652078444 236.0682610072854 L102.02624096739783 253.45818815331012 L104.84464541401121 233.16993981628127 L107.6630498606246 259.2548305353183 L110.48145430723798 217.71222679759268 L113.29985875385046 248.62765283496992 L116.11826320046384 185.83069369654737 L118.93666764707723 204.18672790624012 L121.75507209369061 208.05115616091229 L124.573476540304 266.98368704466264 L127.39188098691648 263.1192587899905 L130.21028543352986 235.10215394361737 L133.02868988014325 223.5088691796009 L135.84709432675663 211.91558441558442 L138.66549877337002 228.33940449794108 L141.4839032199825 216.74611973392462 L144.30230766659588 203.22062084257206 L147.12071211320927 223.5088691796009 L149.93911655982265 160.71191004117836 L152.75752100643604 211.91558441558442 L155.5759254530485 192.59344314222363 L158.3943298996619 235.10215394361737 L161.21273434627528 222.54276211593285 L164.03113879288867 194.52565726955973 L166.84954323950205 180.03405131453914 L169.66794768611544 212.88169147925245 L172.48635213272792 202.25451377890403 L175.3047565793413 180.03405131453914 L178.1231610259547 221.5766550522648 L180.94156547256807 176.16962305986698 L183.75996991918146 171.33908774152678 L186.57837436579393 194.52565726955973 L189.39677881240732 165.54244535951852 L192.2151832590207 158.77969591384226 L195.0335877056341 175.20351599619892 L197.85199215224748 173.27130186886285 L200.67039659885995 145.25419702248973 L203.48880104547334 189.69512195121953 L206.30720549208672 184.86458663287934 L209.1256099387001 208.05115616091229 L211.9440143853135 187.76290782388344 L214.76241883192597 200.32229965156796 L217.58082327853936 213.84779854292051 L220.39922772515274 223.5088691796009 L223.21763217176613 168.44076655052265 L226.0360366183795 171.33908774152678 L228.854441064992 192.59344314222363 L231.67284551160537 185.83069369654737 L234.49124995821876 211.91558441558442 L237.30965440483214 201.288406715236 L240.12805885144553 152.98305353183403 L242.946463298058 173.27130186886285 L245.7648677446714 170.37298067785875 L248.58327219128478 163.61023123218246 L251.40167663789816 176.16962305986698 L254.22008108451155 170.37298067785875 L257.038485531124 192.59344314222363 L259.8568899777374 212.88169147925245 L262.6752944243508 201.288406715236 L265.4936988709642 209.98337028824835 L268.31210331757757 205.15283496990816 L271.13050776419004 231.2377256889452 L273.9489122108034 174.23740893253088 L276.7673166574168 212.88169147925245 L279.5857211040302 230.27161862527717 L282.4041255506436 174.23740893253088 L285.22252999725606 211.91558441558442 L288.04093444386945 191.6273360785556 L290.85933889048283 201.288406715236 L293.6777433370962 201.288406715236 L296.4961477837096 184.86458663287934 L299.314552230323 204.18672790624012 L302.13295667693546 153.94916059550206 L304.95136112354885 143.32198289515364 L307.76976557016224 173.27130186886285 L310.5881700167756 150.08473234082993 L313.406574463389 177.135730123535 L316.2249789100015 211.91558441558442 L319.04338335661487 164.5763382958505 L321.86178780322825 165.54244535951852 L324.68019224984164 141.38976876781754 L327.498596696455 162.64412416851442 L330.3170011430675 148.15251821349383 L333.1354055896809 142.3558758314856 L335.95381003629427 149.11862527716187 L338.77221448290766 155.88137472283813 L341.59061892952104 175.20351599619892 L344.4090233761335 117.23709217611658 L347.2274278227469 156.8474817865062 L350.0458322693603 149.11862527716187 L352.8642367159737 122.06762749445677 L355.68264116258706 116.27098511244854 L358.50104560919954 128.83037694013305 L361.3194500558129 150.08473234082993 L364.1378545024263 100.81327209375992 L366.9562589490397 129.79648400380108 L369.7746633956531 108.54212860310423 L372.59306784226555 123.99984162179285 L375.41147228887894 113.37266392144441 L378.2298767354923 78.59280962939502 L381.0482811821057 137.5253405131454 L383.8666856287191 122.06762749445677 L386.6850900753316 113.37266392144441 L389.50349452194496 136.55923344947738 L392.32189896855834 123.99984162179285 L395.14030341517173 123.99984162179285 L397.9587078617851 109.50823566677226 L400.7771123083976 79.55891669306305 L403.595516755011 29.321349382325025 L406.41392120162436 65.06731073804245 L409.23232564823775 70.8639531200507 L412.05073009485113 82.45723788406718 L414.8691345414636 40.914634146341484 L417.687538988077 82.45723788406718 L420.5059434346904 76.66059550205894 L423.32434788130377 73.76227431105481 L426.14275232791715 15.795850490972441 " fill="none" stroke-width="2.2" stroke="rgb(152,78,163)" stroke-opacity="1.0">
                </path>
              </g>
            </g>
            <g>
              <g transform="rotate(0.0 20.292512015615102 181.9662654418752 ) ">
                <g transform="translate(20.292512015615102 186.1662654418752 ) ">
                  <text style="fill:#000000;font-size:14.0px;font-family:sans-serif;" fill-opacity="1.0" y="0.0">
                    <tspan>1951—1980 average</tspan>
                  </text>
                </g>
              </g>
            </g>
          </g>
        </g>
        <defs>
          <clippath id="cBCeFpu">
            <rect x="35.01530667574961" y="0.0" width="446.4352643435323" height="305.0">
            </rect>
          </clippath>
        </defs>
        <defs>
          <clippath id="cHhvWG5">
            <rect x="35.01530667574961" y="0.0" width="446.4352643435323" height="305.0">
            </rect>
          </clippath>
        </defs>
        <defs>
          <clippath id="ced4zan">
            <rect x="35.01530667574961" y="0.0" width="446.4352643435323" height="305.0">
            </rect>
          </clippath>
        </defs>
      </g>
      <g>
        <g transform="translate(35.01530667574961 305.0 ) ">
          <g transform="translate(20.292512015615102 0.0 ) ">
            <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
            </line>
            <g transform="translate(0.0 7.0 ) ">
              <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                <tspan>1880</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(76.66060094787917 0.0 ) ">
            <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
            </line>
            <g transform="translate(0.0 7.0 ) ">
              <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                <tspan>1900</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(133.02868988014325 0.0 ) ">
            <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
            </line>
            <g transform="translate(0.0 7.0 ) ">
              <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                <tspan>1920</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(189.39677881240732 0.0 ) ">
            <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
            </line>
            <g transform="translate(0.0 7.0 ) ">
              <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                <tspan>1940</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(245.7648677446714 0.0 ) ">
            <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
            </line>
            <g transform="translate(0.0 7.0 ) ">
              <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                <tspan>1960</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(302.13295667693546 0.0 ) ">
            <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
            </line>
            <g transform="translate(0.0 7.0 ) ">
              <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                <tspan>1980</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(358.50104560919954 0.0 ) ">
            <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
            </line>
            <g transform="translate(0.0 7.0 ) ">
              <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                <tspan>2000</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(414.8691345414636 0.0 ) ">
            <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
            </line>
            <g transform="translate(0.0 7.0 ) ">
              <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                <tspan>2020</tspan>
              </text>
            </g>
          </g>
          <line x1="0.0" y1="0.0" x2="446.4352643435323" y2="0.0" stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0">
          </line>
        </g>
        <g transform="translate(35.01530667574961 0.0 ) ">
          <g transform="translate(0.0 288.2380424453595 ) ">
            <g transform="translate(-3.0 0.0 ) ">
              <text class="axis-text-y" text-anchor="end" dy="0.35em">
                <tspan>-1.0</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(0.0 239.93268926195756 ) ">
            <g transform="translate(-3.0 0.0 ) ">
              <text class="axis-text-y" text-anchor="end" dy="0.35em">
                <tspan>-0.5</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(0.0 191.6273360785556 ) ">
            <g transform="translate(-3.0 0.0 ) ">
              <text class="axis-text-y" text-anchor="end" dy="0.35em">
                <tspan>0.0</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(0.0 143.32198289515364 ) ">
            <g transform="translate(-3.0 0.0 ) ">
              <text class="axis-text-y" text-anchor="end" dy="0.35em">
                <tspan>0.5</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(0.0 95.01662971175168 ) ">
            <g transform="translate(-3.0 0.0 ) ">
              <text class="axis-text-y" text-anchor="end" dy="0.35em">
                <tspan>1.0</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(0.0 46.711276528349714 ) ">
            <g transform="translate(-3.0 0.0 ) ">
              <text class="axis-text-y" text-anchor="end" dy="0.35em">
                <tspan>1.5</tspan>
              </text>
            </g>
          </g>
        </g>
      </g>
    </g>
    <g transform="translate(64.51530667574961 16.8 ) ">
      <text class="plot-title" y="0.0">
        <tspan>Average annual temperature anomaly in </tspan>
      </text>
      <text class="plot-title" y="16.0">
        <tspan> in the northern hemisphere (1880—2024)</tspan>
      </text>
    </g>
    <g transform="translate(16.0 195.0 ) rotate(-90.0 ) ">
      <text class="axis-title-y" y="0.0" text-anchor="middle">
        <tspan>Annual temperature anomalies</tspan>
      </text>
    </g>
    <g transform="translate(287.73293884751575 393.0 ) ">
      <text class="axis-title-x" y="0.0" text-anchor="middle">
        <tspan>Year</tspan>
      </text>
    </g>
    <g transform="translate(522.4505710192819 132.75 ) ">
      <rect x="0.0" y="0.0" height="124.5" width="77.54942898071809" stroke="rgb(71,71,71)" stroke-opacity="1.0" stroke-width="0.0" fill="rgb(255,255,255)" fill-opacity="1.0">
      </rect>
      <g transform="translate(5.0 5.0 ) ">
        <g transform="translate(0.0 12.0 ) ">
          <text class="legend-title" y="0.0">
            <tspan>season</tspan>
          </text>
        </g>
        <g transform="translate(0.0 22.5 ) ">
          <g transform="">
            <g>
              <g transform="translate(1.0 1.0 ) ">
                <g>
                  <line x1="0.0" y1="10.5" x2="21.0" y2="10.5" stroke="rgb(228,26,28)" stroke-opacity="1.0" fill="rgb(255,255,255)" fill-opacity="1.0" stroke-width="1.6500000000000001">
                  </line>
                </g>
              </g>
            </g>
            <g transform="translate(26.9903027277341 16.05 ) ">
              <text class="legend-item" y="0.0">
                <tspan>MAM</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(0.0 23.0 ) ">
            <g>
              <g transform="translate(1.0 1.0 ) ">
                <g>
                  <line x1="0.0" y1="10.5" x2="21.0" y2="10.5" stroke="rgb(55,126,184)" stroke-opacity="1.0" fill="rgb(255,255,255)" fill-opacity="1.0" stroke-width="1.6500000000000001">
                  </line>
                </g>
              </g>
            </g>
            <g transform="translate(26.9903027277341 16.05 ) ">
              <text class="legend-item" y="0.0">
                <tspan>JJA</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(0.0 46.0 ) ">
            <g>
              <g transform="translate(1.0 1.0 ) ">
                <g>
                  <line x1="0.0" y1="10.5" x2="21.0" y2="10.5" stroke="rgb(77,175,74)" stroke-opacity="1.0" fill="rgb(255,255,255)" fill-opacity="1.0" stroke-width="1.6500000000000001">
                  </line>
                </g>
              </g>
            </g>
            <g transform="translate(26.9903027277341 16.05 ) ">
              <text class="legend-item" y="0.0">
                <tspan>SON</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(0.0 69.0 ) ">
            <g>
              <g transform="translate(1.0 1.0 ) ">
                <g>
                  <line x1="0.0" y1="10.5" x2="21.0" y2="10.5" stroke="rgb(152,78,163)" stroke-opacity="1.0" fill="rgb(255,255,255)" fill-opacity="1.0" stroke-width="1.6500000000000001">
                  </line>
                </g>
              </g>
            </g>
            <g transform="translate(26.9903027277341 16.05 ) ">
              <text class="legend-item" y="0.0">
                <tspan>DJF</tspan>
              </text>
            </g>
          </g>
        </g>
      </g>
    </g>
    <path fill="rgb(0,0,0)" fill-opacity="0.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" stroke-width="0.0" d="M0.0 0.0 L0.0 400.0 L600.0 400.0 L600.0 0.0 Z" pointer-events="none">
    </path>
  </g>
  <g id="dXvMHfO">
  </g>
</svg>
</div>
</div>
<div id="cell-22" class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Python Walkthrough 1.8</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>df_co2 <span class="op">=</span> pd.read_csv(<span class="st">"D:</span><span class="ch">\360</span><span class="st">MoveData\Users</span><span class="ch">\75</span><span class="st">903\Desktop\SuYibo-Homework\Practice1 SuYibo/CO2-data.csv"</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>df_co2.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Month</th>
<th data-quarto-table-cell-role="th">Monthly average</th>
<th data-quarto-table-cell-role="th">Interpolated</th>
<th data-quarto-table-cell-role="th">Trend</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1958</td>
<td>3</td>
<td>315.71</td>
<td>315.71</td>
<td>314.62</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1958</td>
<td>4</td>
<td>317.45</td>
<td>317.45</td>
<td>315.29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1958</td>
<td>5</td>
<td>317.50</td>
<td>317.50</td>
<td>314.71</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1958</td>
<td>6</td>
<td>-99.99</td>
<td>317.10</td>
<td>314.85</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1958</td>
<td>7</td>
<td>315.86</td>
<td>315.86</td>
<td>314.98</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-23" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>df_co2_june <span class="op">=</span> df_co2.loc[df_co2[<span class="st">"Month"</span>] <span class="op">==</span> <span class="dv">6</span>]</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>df_co2_june.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Month</th>
<th data-quarto-table-cell-role="th">Monthly average</th>
<th data-quarto-table-cell-role="th">Interpolated</th>
<th data-quarto-table-cell-role="th">Trend</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>1958</td>
<td>6</td>
<td>-99.99</td>
<td>317.10</td>
<td>314.85</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>1959</td>
<td>6</td>
<td>318.15</td>
<td>318.15</td>
<td>315.92</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">27</td>
<td>1960</td>
<td>6</td>
<td>319.59</td>
<td>319.59</td>
<td>317.36</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">39</td>
<td>1961</td>
<td>6</td>
<td>319.77</td>
<td>319.77</td>
<td>317.48</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">51</td>
<td>1962</td>
<td>6</td>
<td>320.55</td>
<td>320.55</td>
<td>318.27</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-24" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>df_temp_co2 <span class="op">=</span> pd.merge(df_co2_june, df, on<span class="op">=</span><span class="st">"Year"</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>df_temp_co2[[<span class="st">"Year"</span>, <span class="st">"Jun"</span>, <span class="st">"Trend"</span>]].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Jun</th>
<th data-quarto-table-cell-role="th">Trend</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1958</td>
<td>0.05</td>
<td>314.85</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1959</td>
<td>0.14</td>
<td>315.92</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1960</td>
<td>0.18</td>
<td>317.36</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1961</td>
<td>0.18</td>
<td>317.48</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1962</td>
<td>-0.13</td>
<td>318.27</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-25" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>    ggplot(df_temp_co2, aes(x<span class="op">=</span><span class="st">"Jun"</span>, y<span class="op">=</span><span class="st">"Trend"</span>))</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> geom_point(color<span class="op">=</span><span class="st">"black"</span>, size<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> labs(</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">"Scatterplot of temperature anomalies vs carbon dioxide emissions"</span>,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">"Carbon dioxide levels (trend, mole fraction)"</span>,</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">"Temperature anomaly (degrees Celsius)"</span>,</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" display="block" class="plt-container" width="600.0" height="400.0">
  <style type="text/css">
  .plt-container {
   font-family: Lucida Grande, sans-serif;
   user-select: none;
   -webkit-user-select: none;
   -moz-user-select: none;
   -ms-user-select: none;
}
text {
   text-rendering: optimizeLegibility;
}
#pG3fCA2 .plot-title {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 16.0px;

}
#pG3fCA2 .plot-subtitle {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 15.0px;

}
#pG3fCA2 .plot-caption {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#pG3fCA2 .hyperlink-element {
fill: #118ed8;
font-weight: normal;
   font-style: normal;
}
#pG3fCA2 .legend-title {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 15.0px;

}
#pG3fCA2 .legend-item {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#pG3fCA2 .axis-title-x {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 15.0px;

}
#pG3fCA2 .axis-text-x {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#dfLJFqA .axis-tooltip-text-x {
fill: #ffffff;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#pG3fCA2 .axis-title-y {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 15.0px;

}
#pG3fCA2 .axis-text-y {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#dfLJFqA .axis-tooltip-text-y {
fill: #ffffff;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#pG3fCA2 .facet-strip-text-x {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#pG3fCA2 .facet-strip-text-y {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#dfLJFqA .tooltip-text {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#dfLJFqA .tooltip-title {
fill: #474747;
font-weight: bold;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#dfLJFqA .tooltip-label {
fill: #474747;
font-weight: bold;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}

  </style>
  <g id="pG3fCA2">
    <path fill-rule="evenodd" fill="rgb(255,255,255)" fill-opacity="1.0" d="M0.0 0.0 L0.0 400.0 L600.0 400.0 L600.0 0.0 Z">
    </path>
    <g transform="translate(29.5 26.5 ) ">
      <g>
        <g transform="translate(29.941816366404606 0.0 ) ">
          <g>
            <line x1="24.275371983345252" y1="0.0" x2="24.275371983345252" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="97.28400952724073" y1="0.0" x2="97.28400952724073" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="170.2926470711362" y1="0.0" x2="170.2926470711362" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="243.30128461503168" y1="0.0" x2="243.30128461503168" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="316.3099221589272" y1="0.0" x2="316.3099221589272" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="389.31855970282265" y1="0.0" x2="389.31855970282265" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="462.32719724671813" y1="0.0" x2="462.32719724671813" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
          </g>
        </g>
        <g transform="translate(29.941816366404606 0.0 ) ">
          <g>
            <line x1="0.0" y1="290.01659923845796" x2="534.0581836335954" y2="290.01659923845796" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="0.0" y1="226.35643741075683" x2="534.0581836335954" y2="226.35643741075683" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="0.0" y1="162.6962755830557" x2="534.0581836335954" y2="162.6962755830557" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="0.0" y1="99.03611375535456" x2="534.0581836335954" y2="99.03611375535456" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="0.0" y1="35.37595192765343" x2="534.0581836335954" y2="35.37595192765343" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
          </g>
        </g>
      </g>
      <g clip-path="url(#c4mPKq5)" clip-bounds-jfx="[rect (29.941816366404606, 0.0), (534.0581836335954, 321.0)]">
        <g transform="translate(29.941816366404606 0.0 ) ">
          <g>
            <g>
              <g>
                <g>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="115.5361689132146" cy="306.4090909090909" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="148.39005580796757" cy="303.0032722513089" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="162.99178331674665" cy="298.4197405997144" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="162.99178331674665" cy="298.03777962874824" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="49.82839512370867" cy="295.5232032365541" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="82.68228201846163" cy="292.69032603522123" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="64.43012263248777" cy="291.00333174678724" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="24.275371983345252" cy="291.1306520704427" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="119.18660079040937" cy="285.17842693955265" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="75.38141826407208" cy="283.8415635411709" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="79.03185014126686" cy="279.83097334602576" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="82.68228201846163" cy="275.279271775345" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="104.58487328163028" cy="272.4463945740124" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="46.17796324651389" cy="269.64534745359356" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="60.77969075529299" cy="267.99018324607323" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="155.69091956235712" cy="258.3774988100904" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="31.576235737734805" cy="258.3774988100904" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="68.08055450968254" cy="254.36690861494526" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="24.275371983345252" cy="252.93455497382206" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="181.24394270272052" cy="246.09108757734407" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="46.17796324651389" cy="240.39350309376505" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="126.48746454479891" cy="236.41474297953368" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="166.6422151939414" cy="230.0487267967635" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="199.49610208869439" cy="226.13362684435992" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="100.9344414044355" cy="222.05937648738677" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="137.43876017638325" cy="216.32996192289397" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="130.13789642199367" cy="212.00107091861014" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="97.28400952724073" cy="207.44936934792963" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="148.39005580796757" cy="202.42021656354132" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="155.69091956235712" cy="197.0727629700143" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="243.30128461503168" cy="190.16563541170876" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="184.89437457991528" cy="185.07282246549244" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="272.50473963258986" cy="181.88981437410757" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="268.8543077553951" cy="176.06490956687276" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="111.88573703601982" cy="172.3407900999523" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="177.59351082552575" cy="171.86333888624472" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="246.95171649222644" cy="167.66176820561645" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="279.80560338697944" cy="160.0225487862922" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="188.54480645711007" cy="154.13398381722982" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="276.1551715097846" cy="151.84221799143256" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="363.76553656245915" cy="141.05182056163721" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="225.04912522905778" cy="136.81841980009517" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="257.90301212381075" cy="132.45769871489756" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="287.10646714136897" cy="127.71501665873393" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="345.5133771764854" cy="120.36226796763435" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="294.4073308957585" cy="111.67265587815336" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="268.8543077553951" cy="107.34376487386953" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="385.66812782562783" cy="99.41807472632081" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="392.9689915800175" cy="93.46584959543065" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="334.56208154490105" cy="86.81336268443602" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="323.6107859133167" cy="81.65688957639213" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="341.8629452992906" cy="75.99113517372666" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="403.9202872116017" cy="67.55616373155635" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="374.7168321940435" cy="62.6225011899096" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="440.42460598354944" cy="56.22465492622564" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="382.01769594843313" cy="47.21674202760596" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="392.9689915800175" cy="38.71811042360787" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="484.2297885098868" cy="33.816277962874665" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="509.7828116502501" cy="21.05241551642075" r="3.3000000000000003"></circle>
                  <circle fill="#000000" stroke="#000000" stroke-opacity="0.0" stroke-width="0.0" cx="436.77417410635474" cy="14.590909090909008" r="3.3000000000000003"></circle>
                </g>
              </g>
            </g>
          </g>
        </g>
        <defs>
          <clippath id="c4mPKq5">
            <rect x="29.941816366404606" y="0.0" width="534.0581836335954" height="321.0">
            </rect>
          </clippath>
        </defs>
      </g>
      <g>
        <g transform="translate(29.941816366404606 321.0 ) ">
          <g transform="translate(24.275371983345252 0.0 ) ">
            <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
            </line>
            <g transform="translate(0.0 7.0 ) ">
              <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                <tspan>-0.2</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(97.28400952724073 0.0 ) ">
            <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
            </line>
            <g transform="translate(0.0 7.0 ) ">
              <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                <tspan>0.0</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(170.2926470711362 0.0 ) ">
            <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
            </line>
            <g transform="translate(0.0 7.0 ) ">
              <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                <tspan>0.2</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(243.30128461503168 0.0 ) ">
            <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
            </line>
            <g transform="translate(0.0 7.0 ) ">
              <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                <tspan>0.4</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(316.3099221589272 0.0 ) ">
            <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
            </line>
            <g transform="translate(0.0 7.0 ) ">
              <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                <tspan>0.6</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(389.31855970282265 0.0 ) ">
            <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
            </line>
            <g transform="translate(0.0 7.0 ) ">
              <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                <tspan>0.8</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(462.32719724671813 0.0 ) ">
            <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
            </line>
            <g transform="translate(0.0 7.0 ) ">
              <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                <tspan>1.0</tspan>
              </text>
            </g>
          </g>
          <line x1="0.0" y1="0.0" x2="534.0581836335954" y2="0.0" stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0">
          </line>
        </g>
        <g transform="translate(29.941816366404606 0.0 ) ">
          <g transform="translate(0.0 290.01659923845796 ) ">
            <g transform="translate(-3.0 0.0 ) ">
              <text class="axis-text-y" text-anchor="end" dy="0.35em">
                <tspan>320</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(0.0 226.35643741075683 ) ">
            <g transform="translate(-3.0 0.0 ) ">
              <text class="axis-text-y" text-anchor="end" dy="0.35em">
                <tspan>340</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(0.0 162.6962755830557 ) ">
            <g transform="translate(-3.0 0.0 ) ">
              <text class="axis-text-y" text-anchor="end" dy="0.35em">
                <tspan>360</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(0.0 99.03611375535456 ) ">
            <g transform="translate(-3.0 0.0 ) ">
              <text class="axis-text-y" text-anchor="end" dy="0.35em">
                <tspan>380</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(0.0 35.37595192765343 ) ">
            <g transform="translate(-3.0 0.0 ) ">
              <text class="axis-text-y" text-anchor="end" dy="0.35em">
                <tspan>400</tspan>
              </text>
            </g>
          </g>
        </g>
      </g>
    </g>
    <g transform="translate(59.44181636640461 16.8 ) ">
      <text class="plot-title" y="0.0">
        <tspan>Scatterplot of temperature anomalies vs carbon dioxide emissions</tspan>
      </text>
    </g>
    <g transform="translate(16.0 187.0 ) rotate(-90.0 ) ">
      <text class="axis-title-y" y="0.0" text-anchor="middle">
        <tspan>Carbon dioxide levels (trend, mole fraction)</tspan>
      </text>
    </g>
    <g transform="translate(326.4709081832023 393.0 ) ">
      <text class="axis-title-x" y="0.0" text-anchor="middle">
        <tspan>Temperature anomaly (degrees Celsius)</tspan>
      </text>
    </g>
    <path fill="rgb(0,0,0)" fill-opacity="0.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" stroke-width="0.0" d="M0.0 0.0 L0.0 400.0 L600.0 400.0 L600.0 0.0 Z" pointer-events="none">
    </path>
  </g>
  <g id="dfLJFqA">
  </g>
</svg>
</div>
</div>
<div id="cell-26" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>df_temp_co2[[<span class="st">"Jun"</span>, <span class="st">"Trend"</span>]].corr(method<span class="op">=</span><span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Jun</th>
<th data-quarto-table-cell-role="th">Trend</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Jun</td>
<td>1.00000</td>
<td>0.91495</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Trend</td>
<td>0.91495</td>
<td>1.00000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-27" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>    ggplot(df_temp_co2, aes(x<span class="op">=</span><span class="st">"Year"</span>, y<span class="op">=</span><span class="st">"Jun"</span>))</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> geom_line(size<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> labs(</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">"June temperature anomalies"</span>,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> scale_x_continuous(<span class="bu">format</span><span class="op">=</span><span class="st">"d"</span>)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" display="block" class="plt-container" width="600.0" height="400.0">
  <style type="text/css">
  .plt-container {
   font-family: Lucida Grande, sans-serif;
   user-select: none;
   -webkit-user-select: none;
   -moz-user-select: none;
   -ms-user-select: none;
}
text {
   text-rendering: optimizeLegibility;
}
#pw19SDW .plot-title {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 16.0px;

}
#pw19SDW .plot-subtitle {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 15.0px;

}
#pw19SDW .plot-caption {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#pw19SDW .hyperlink-element {
fill: #118ed8;
font-weight: normal;
   font-style: normal;
}
#pw19SDW .legend-title {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 15.0px;

}
#pw19SDW .legend-item {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#pw19SDW .axis-title-x {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 15.0px;

}
#pw19SDW .axis-text-x {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#dXAXVDG .axis-tooltip-text-x {
fill: #ffffff;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#pw19SDW .axis-title-y {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 15.0px;

}
#pw19SDW .axis-text-y {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#dXAXVDG .axis-tooltip-text-y {
fill: #ffffff;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#pw19SDW .facet-strip-text-x {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#pw19SDW .facet-strip-text-y {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#dXAXVDG .tooltip-text {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#dXAXVDG .tooltip-title {
fill: #474747;
font-weight: bold;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#dXAXVDG .tooltip-label {
fill: #474747;
font-weight: bold;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}

  </style>
  <g id="pw19SDW">
    <path fill-rule="evenodd" fill="rgb(255,255,255)" fill-opacity="1.0" d="M0.0 0.0 L0.0 400.0 L600.0 400.0 L600.0 0.0 Z">
    </path>
    <g transform="translate(29.5 26.5 ) ">
      <g>
        <g transform="translate(35.01530667574961 0.0 ) ">
          <g>
            <line x1="40.3462901687999" y1="0.0" x2="40.3462901687999" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="121.85394707546402" y1="0.0" x2="121.85394707546402" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="203.36160398212814" y1="0.0" x2="203.36160398212814" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="284.86926088879227" y1="0.0" x2="284.86926088879227" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="366.3769177954564" y1="0.0" x2="366.3769177954564" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="447.8845747021205" y1="0.0" x2="447.8845747021205" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
          </g>
        </g>
        <g transform="translate(35.01530667574961 0.0 ) ">
          <g>
            <line x1="0.0" y1="306.40909090909093" x2="528.9846933242504" y2="306.40909090909093" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="0.0" y1="262.52665755297335" x2="528.9846933242504" y2="262.52665755297335" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="0.0" y1="218.64422419685576" x2="528.9846933242504" y2="218.64422419685576" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="0.0" y1="174.7617908407382" x2="528.9846933242504" y2="174.7617908407382" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="0.0" y1="130.8793574846206" x2="528.9846933242504" y2="130.8793574846206" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="0.0" y1="86.99692412850305" x2="528.9846933242504" y2="86.99692412850305" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
            <line x1="0.0" y1="43.114490772385494" x2="528.9846933242504" y2="43.114490772385494" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
            </line>
          </g>
        </g>
      </g>
      <g clip-path="url(#c55QfY7)" clip-bounds-jfx="[rect (35.01530667574961, 0.0), (528.9846933242504, 321.0)]">
        <g transform="translate(35.01530667574961 0.0 ) ">
          <g>
            <g>
              <g>
                <path d="M24.04475878746598 251.55604921394396 L24.04475878746598 251.55604921394396 L32.19552447813294 231.80895420369103 L40.3462901687999 223.03246753246754 L48.497055859465036 223.03246753246754 L56.647821550131994 291.05023923444975 L64.79858724079895 271.30314422419684 L72.94935293146591 282.27375256322625 L81.10011862213105 306.40909090909093 L89.25088431279801 249.36192754613808 L97.40165000346497 275.6913875598086 L105.5524156941301 273.49726589200276 L113.70318138479706 271.30314422419684 L121.85394707546402 258.13841421736157 L130.00471276612916 293.24436090225566 L138.15547845679612 284.4678742310321 L146.30624414746308 227.42071086807928 L154.45700983812822 302.02084757347916 L162.60777552879517 280.0796308954204 L170.75854121946213 306.40909090909093 L178.9093069101291 212.06185919343812 L187.06007260079423 293.24436090225566 L195.2108382914612 244.97368421052633 L203.36160398212814 220.83834586466165 L211.51236967279328 201.09125085440874 L219.66313536346024 260.3325358851675 L227.8139010541272 238.3913192071087 L235.96466674479234 242.77956254272044 L244.1154324354593 262.52665755297335 L252.26619812612626 231.80895420369103 L260.4169638167932 227.42071086807928 L268.56772950745835 174.7617908407382 L276.7184951981253 209.86773752563226 L284.86926088879227 157.20881749829118 L293.0200265794574 159.40293916609704 L301.17079227012437 253.75017088174982 L309.3215579607913 214.255980861244 L317.47232365145646 172.5676691729323 L325.6230893421234 152.8205741626794 L333.7738550327904 207.67361585782638 L341.9246207234555 155.0146958304853 L350.0753864141225 102.35577580314421 L358.22615210478943 185.73239917976758 L366.3769177954564 165.98530416951468 L374.52768348612153 148.43233082706766 L382.6784491767885 113.3263841421736 L390.82921486745545 144.0440874914559 L398.9799805581206 159.40293916609704 L407.13074624878755 89.19104579630894 L415.2815119394545 84.80280246069717 L423.43227763011964 119.90874914559123 L431.5830433207866 126.49111414900887 L439.73380901145356 115.52050580997948 L447.8845747021205 78.22043745727956 L456.03534039278566 95.77341079972658 L464.1861060834508 56.279220779220765 L472.3368717741196 91.38516746411483 L480.4876374647847 84.80280246069717 L488.6384031554535 29.949760765550224 L496.7891688461186 14.590909090909093 L504.93993453678377 58.473342447026624 " fill="none" stroke-width="2.2" stroke="rgb(71,71,71)" stroke-opacity="1.0">
                </path>
              </g>
            </g>
          </g>
        </g>
        <defs>
          <clippath id="c55QfY7">
            <rect x="35.01530667574961" y="0.0" width="528.9846933242504" height="321.0">
            </rect>
          </clippath>
        </defs>
      </g>
      <g>
        <g transform="translate(35.01530667574961 321.0 ) ">
          <g transform="translate(40.3462901687999 0.0 ) ">
            <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
            </line>
            <g transform="translate(0.0 7.0 ) ">
              <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                <tspan>1960</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(121.85394707546402 0.0 ) ">
            <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
            </line>
            <g transform="translate(0.0 7.0 ) ">
              <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                <tspan>1970</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(203.36160398212814 0.0 ) ">
            <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
            </line>
            <g transform="translate(0.0 7.0 ) ">
              <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                <tspan>1980</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(284.86926088879227 0.0 ) ">
            <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
            </line>
            <g transform="translate(0.0 7.0 ) ">
              <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                <tspan>1990</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(366.3769177954564 0.0 ) ">
            <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
            </line>
            <g transform="translate(0.0 7.0 ) ">
              <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                <tspan>2000</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(447.8845747021205 0.0 ) ">
            <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
            </line>
            <g transform="translate(0.0 7.0 ) ">
              <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                <tspan>2010</tspan>
              </text>
            </g>
          </g>
          <line x1="0.0" y1="0.0" x2="528.9846933242504" y2="0.0" stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0">
          </line>
        </g>
        <g transform="translate(35.01530667574961 0.0 ) ">
          <g transform="translate(0.0 306.40909090909093 ) ">
            <g transform="translate(-3.0 0.0 ) ">
              <text class="axis-text-y" text-anchor="end" dy="0.35em">
                <tspan>-0.2</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(0.0 262.52665755297335 ) ">
            <g transform="translate(-3.0 0.0 ) ">
              <text class="axis-text-y" text-anchor="end" dy="0.35em">
                <tspan>0.0</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(0.0 218.64422419685576 ) ">
            <g transform="translate(-3.0 0.0 ) ">
              <text class="axis-text-y" text-anchor="end" dy="0.35em">
                <tspan>0.2</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(0.0 174.7617908407382 ) ">
            <g transform="translate(-3.0 0.0 ) ">
              <text class="axis-text-y" text-anchor="end" dy="0.35em">
                <tspan>0.4</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(0.0 130.8793574846206 ) ">
            <g transform="translate(-3.0 0.0 ) ">
              <text class="axis-text-y" text-anchor="end" dy="0.35em">
                <tspan>0.6</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(0.0 86.99692412850305 ) ">
            <g transform="translate(-3.0 0.0 ) ">
              <text class="axis-text-y" text-anchor="end" dy="0.35em">
                <tspan>0.8</tspan>
              </text>
            </g>
          </g>
          <g transform="translate(0.0 43.114490772385494 ) ">
            <g transform="translate(-3.0 0.0 ) ">
              <text class="axis-text-y" text-anchor="end" dy="0.35em">
                <tspan>1.0</tspan>
              </text>
            </g>
          </g>
        </g>
      </g>
    </g>
    <g transform="translate(64.51530667574961 16.8 ) ">
      <text class="plot-title" y="0.0">
        <tspan>June temperature anomalies</tspan>
      </text>
    </g>
    <g transform="translate(16.0 187.0 ) rotate(-90.0 ) ">
      <text class="axis-title-y" y="0.0" text-anchor="middle">
        <tspan>Jun</tspan>
      </text>
    </g>
    <g transform="translate(329.00765333787484 393.0 ) ">
      <text class="axis-title-x" y="0.0" text-anchor="middle">
        <tspan>Year</tspan>
      </text>
    </g>
    <path fill="rgb(0,0,0)" fill-opacity="0.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" stroke-width="0.0" d="M0.0 0.0 L0.0 400.0 L600.0 400.0 L600.0 0.0 Z" pointer-events="none">
    </path>
  </g>
  <g id="dXAXVDG">
  </g>
</svg>
</div>
</div>
<div id="cell-28" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>base_plot <span class="op">=</span> ggplot(df_temp_co2) <span class="op">+</span> scale_x_continuous(<span class="bu">format</span><span class="op">=</span><span class="st">"d"</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>plot_p <span class="op">=</span> (</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    base_plot</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> geom_line(aes(x<span class="op">=</span><span class="st">"Year"</span>, y<span class="op">=</span><span class="st">"Jun"</span>), size<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> labs(title<span class="op">=</span><span class="st">"June temperature anomalies"</span>)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>plot_q <span class="op">=</span> (</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>    base_plot</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> geom_line(aes(x<span class="op">=</span><span class="st">"Year"</span>, y<span class="op">=</span><span class="st">"Trend"</span>), size<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> labs(title<span class="op">=</span><span class="st">"Carbon dioxide emissions"</span>)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>gggrid([plot_p, plot_q], ncol<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" display="block" class="plt-container" width="900.0" height="400.0">
  <g id="pWEucsO">
    <rect x="0.0" y="0.0" height="400.0" width="900.0" fill="rgb(255,255,255)" fill-opacity="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" stroke-width="0.0">
    </rect>
  </g>
  <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" display="block" class="plt-container" width="448.0" height="400.0" x="0.0" y="0.0">
    <style type="text/css">
    .plt-container {
   font-family: Lucida Grande, sans-serif;
   user-select: none;
   -webkit-user-select: none;
   -moz-user-select: none;
   -ms-user-select: none;
}
text {
   text-rendering: optimizeLegibility;
}
#pg4q90j .plot-title {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 16.0px;

}
#pg4q90j .plot-subtitle {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 15.0px;

}
#pg4q90j .plot-caption {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#pg4q90j .hyperlink-element {
fill: #118ed8;
font-weight: normal;
   font-style: normal;
}
#pg4q90j .legend-title {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 15.0px;

}
#pg4q90j .legend-item {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#pg4q90j .axis-title-x {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 15.0px;

}
#pg4q90j .axis-text-x {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#dGstEd3 .axis-tooltip-text-x {
fill: #ffffff;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#pg4q90j .axis-title-y {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 15.0px;

}
#pg4q90j .axis-text-y {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#dGstEd3 .axis-tooltip-text-y {
fill: #ffffff;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#pg4q90j .facet-strip-text-x {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#pg4q90j .facet-strip-text-y {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#dGstEd3 .tooltip-text {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#dGstEd3 .tooltip-title {
fill: #474747;
font-weight: bold;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#dGstEd3 .tooltip-label {
fill: #474747;
font-weight: bold;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}

    </style>
    <g id="pg4q90j">
      <path fill-rule="evenodd" fill="rgb(255,255,255)" fill-opacity="1.0" d="M0.0 0.0 L0.0 400.0 L448.0 400.0 L448.0 0.0 Z">
      </path>
      <g transform="translate(29.5 26.5 ) ">
        <g>
          <g transform="translate(35.01530667574961 0.0 ) ">
            <g>
              <line x1="28.753069829816013" y1="0.0" x2="28.753069829816013" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
              </line>
              <line x1="86.84007958701841" y1="0.0" x2="86.84007958701841" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
              </line>
              <line x1="144.92708934422262" y1="0.0" x2="144.92708934422262" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
              </line>
              <line x1="203.01409910142502" y1="0.0" x2="203.01409910142502" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
              </line>
              <line x1="261.10110885862923" y1="0.0" x2="261.10110885862923" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
              </line>
              <line x1="319.1881186158316" y1="0.0" x2="319.1881186158316" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
              </line>
            </g>
          </g>
          <g transform="translate(35.01530667574961 0.0 ) ">
            <g>
              <line x1="0.0" y1="306.40909090909093" x2="376.9846933242504" y2="306.40909090909093" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
              </line>
              <line x1="0.0" y1="262.52665755297335" x2="376.9846933242504" y2="262.52665755297335" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
              </line>
              <line x1="0.0" y1="218.64422419685576" x2="376.9846933242504" y2="218.64422419685576" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
              </line>
              <line x1="0.0" y1="174.7617908407382" x2="376.9846933242504" y2="174.7617908407382" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
              </line>
              <line x1="0.0" y1="130.8793574846206" x2="376.9846933242504" y2="130.8793574846206" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
              </line>
              <line x1="0.0" y1="86.99692412850305" x2="376.9846933242504" y2="86.99692412850305" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
              </line>
              <line x1="0.0" y1="43.114490772385494" x2="376.9846933242504" y2="43.114490772385494" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
              </line>
            </g>
          </g>
        </g>
        <g clip-path="url(#cCXC2pI)" clip-bounds-jfx="[rect (35.01530667574961, 0.0), (376.9846933242504, 321.0)]">
          <g transform="translate(35.01530667574961 0.0 ) ">
            <g>
              <g>
                <g>
                  <path d="M17.13566787837408 251.55604921394396 L17.13566787837408 251.55604921394396 L22.944368854094137 231.80895420369103 L28.753069829816013 223.03246753246754 L34.56177080553607 223.03246753246754 L40.37047178125613 291.05023923444975 L46.179172756976186 271.30314422419684 L51.987873732696244 282.27375256322625 L57.7965747084163 306.40909090909093 L63.60527568413636 249.36192754613808 L69.41397665985824 275.6913875598086 L75.2226776355783 273.49726589200276 L81.03137861129835 271.30314422419684 L86.84007958701841 258.13841421736157 L92.64878056273847 293.24436090225566 L98.45748153845852 284.4678742310321 L104.2661825141804 227.42071086807928 L110.07488348990046 302.02084757347916 L115.88358446562052 280.0796308954204 L121.69228544134057 306.40909090909093 L127.50098641706063 212.06185919343812 L133.3096873927807 293.24436090225566 L139.11838836850075 244.97368421052633 L144.92708934422262 220.83834586466165 L150.73579031994268 201.09125085440874 L156.54449129566274 260.3325358851675 L162.3531922713828 238.3913192071087 L168.16189324710285 242.77956254272044 L173.9705942228229 262.52665755297335 L179.77929519854297 231.80895420369103 L185.58799617426484 227.42071086807928 L191.3966971499849 174.7617908407382 L197.20539812570496 209.86773752563226 L203.01409910142502 157.20881749829118 L208.82280007714508 159.40293916609704 L214.63150105286513 253.75017088174982 L220.440202028587 214.255980861244 L226.24890300430707 172.5676691729323 L232.05760398002712 152.8205741626794 L237.86630495574718 207.67361585782638 L243.67500593146724 155.0146958304853 L249.4837069071873 102.35577580314421 L255.29240788290736 185.73239917976758 L261.10110885862923 165.98530416951468 L266.9098098343493 148.43233082706766 L272.71851081006935 113.3263841421736 L278.5272117857894 144.0440874914559 L284.33591276150946 159.40293916609704 L290.1446137372295 89.19104579630894 L295.9533147129514 84.80280246069717 L301.76201568867145 119.90874914559123 L307.5707166643915 126.49111414900887 L313.37941764011157 115.52050580997948 L319.1881186158316 78.22043745727956 L324.9968195915517 95.77341079972658 L330.80552056727174 56.279220779220765 L336.6142215429936 91.38516746411483 L342.4229225187137 84.80280246069717 L348.23162349443373 29.949760765550224 L354.0403244701538 14.590909090909093 L359.84902544587385 58.473342447026624 " fill="none" stroke-width="2.2" stroke="rgb(71,71,71)" stroke-opacity="1.0">
                  </path>
                </g>
              </g>
            </g>
          </g>
          <defs>
            <clippath id="cCXC2pI">
              <rect x="35.01530667574961" y="0.0" width="376.9846933242504" height="321.0">
              </rect>
            </clippath>
          </defs>
        </g>
        <g>
          <g transform="translate(35.01530667574961 321.0 ) ">
            <g transform="translate(28.753069829816013 0.0 ) ">
              <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
              </line>
              <g transform="translate(0.0 7.0 ) ">
                <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                  <tspan>1960</tspan>
                </text>
              </g>
            </g>
            <g transform="translate(86.84007958701841 0.0 ) ">
              <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
              </line>
              <g transform="translate(0.0 7.0 ) ">
                <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                  <tspan>1970</tspan>
                </text>
              </g>
            </g>
            <g transform="translate(144.92708934422262 0.0 ) ">
              <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
              </line>
              <g transform="translate(0.0 7.0 ) ">
                <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                  <tspan>1980</tspan>
                </text>
              </g>
            </g>
            <g transform="translate(203.01409910142502 0.0 ) ">
              <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
              </line>
              <g transform="translate(0.0 7.0 ) ">
                <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                  <tspan>1990</tspan>
                </text>
              </g>
            </g>
            <g transform="translate(261.10110885862923 0.0 ) ">
              <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
              </line>
              <g transform="translate(0.0 7.0 ) ">
                <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                  <tspan>2000</tspan>
                </text>
              </g>
            </g>
            <g transform="translate(319.1881186158316 0.0 ) ">
              <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
              </line>
              <g transform="translate(0.0 7.0 ) ">
                <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                  <tspan>2010</tspan>
                </text>
              </g>
            </g>
            <line x1="0.0" y1="0.0" x2="376.9846933242504" y2="0.0" stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0">
            </line>
          </g>
          <g transform="translate(35.01530667574961 0.0 ) ">
            <g transform="translate(0.0 306.40909090909093 ) ">
              <g transform="translate(-3.0 0.0 ) ">
                <text class="axis-text-y" text-anchor="end" dy="0.35em">
                  <tspan>-0.2</tspan>
                </text>
              </g>
            </g>
            <g transform="translate(0.0 262.52665755297335 ) ">
              <g transform="translate(-3.0 0.0 ) ">
                <text class="axis-text-y" text-anchor="end" dy="0.35em">
                  <tspan>0.0</tspan>
                </text>
              </g>
            </g>
            <g transform="translate(0.0 218.64422419685576 ) ">
              <g transform="translate(-3.0 0.0 ) ">
                <text class="axis-text-y" text-anchor="end" dy="0.35em">
                  <tspan>0.2</tspan>
                </text>
              </g>
            </g>
            <g transform="translate(0.0 174.7617908407382 ) ">
              <g transform="translate(-3.0 0.0 ) ">
                <text class="axis-text-y" text-anchor="end" dy="0.35em">
                  <tspan>0.4</tspan>
                </text>
              </g>
            </g>
            <g transform="translate(0.0 130.8793574846206 ) ">
              <g transform="translate(-3.0 0.0 ) ">
                <text class="axis-text-y" text-anchor="end" dy="0.35em">
                  <tspan>0.6</tspan>
                </text>
              </g>
            </g>
            <g transform="translate(0.0 86.99692412850305 ) ">
              <g transform="translate(-3.0 0.0 ) ">
                <text class="axis-text-y" text-anchor="end" dy="0.35em">
                  <tspan>0.8</tspan>
                </text>
              </g>
            </g>
            <g transform="translate(0.0 43.114490772385494 ) ">
              <g transform="translate(-3.0 0.0 ) ">
                <text class="axis-text-y" text-anchor="end" dy="0.35em">
                  <tspan>1.0</tspan>
                </text>
              </g>
            </g>
          </g>
        </g>
      </g>
      <g transform="translate(64.51530667574961 16.8 ) ">
        <text class="plot-title" y="0.0">
          <tspan>June temperature anomalies</tspan>
        </text>
      </g>
      <g transform="translate(16.0 187.0 ) rotate(-90.0 ) ">
        <text class="axis-title-y" y="0.0" text-anchor="middle">
          <tspan>Jun</tspan>
        </text>
      </g>
      <g transform="translate(253.00765333787479 393.0 ) ">
        <text class="axis-title-x" y="0.0" text-anchor="middle">
          <tspan>Year</tspan>
        </text>
      </g>
      <path fill="rgb(0,0,0)" fill-opacity="0.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" stroke-width="0.0" d="M0.0 0.0 L0.0 400.0 L448.0 400.0 L448.0 0.0 Z" pointer-events="none">
      </path>
    </g>
    <g id="dGstEd3">
    </g>
  </svg>
  <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" display="block" class="plt-container" width="448.0" height="400.0" x="452.0" y="0.0">
    <style type="text/css">
    .plt-container {
   font-family: Lucida Grande, sans-serif;
   user-select: none;
   -webkit-user-select: none;
   -moz-user-select: none;
   -ms-user-select: none;
}
text {
   text-rendering: optimizeLegibility;
}
#pK2rdh3 .plot-title {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 16.0px;

}
#pK2rdh3 .plot-subtitle {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 15.0px;

}
#pK2rdh3 .plot-caption {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#pK2rdh3 .hyperlink-element {
fill: #118ed8;
font-weight: normal;
   font-style: normal;
}
#pK2rdh3 .legend-title {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 15.0px;

}
#pK2rdh3 .legend-item {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#pK2rdh3 .axis-title-x {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 15.0px;

}
#pK2rdh3 .axis-text-x {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#duF5zvT .axis-tooltip-text-x {
fill: #ffffff;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#pK2rdh3 .axis-title-y {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 15.0px;

}
#pK2rdh3 .axis-text-y {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#duF5zvT .axis-tooltip-text-y {
fill: #ffffff;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#pK2rdh3 .facet-strip-text-x {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#pK2rdh3 .facet-strip-text-y {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#duF5zvT .tooltip-text {
fill: #474747;
font-weight: normal;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#duF5zvT .tooltip-title {
fill: #474747;
font-weight: bold;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}
#duF5zvT .tooltip-label {
fill: #474747;
font-weight: bold;
   font-style: normal;font-family: Lucida Grande, sans-serif;
font-size: 13.0px;

}

    </style>
    <g id="pK2rdh3">
      <path fill-rule="evenodd" fill="rgb(255,255,255)" fill-opacity="1.0" d="M0.0 0.0 L0.0 400.0 L448.0 400.0 L448.0 0.0 Z">
      </path>
      <g transform="translate(29.5 26.5 ) ">
        <g>
          <g transform="translate(29.941816366404606 0.0 ) ">
            <g>
              <line x1="29.14003095510634" y1="0.0" x2="29.14003095510634" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
              </line>
              <line x1="88.00878035935784" y1="0.0" x2="88.00878035935784" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
              </line>
              <line x1="146.87752976360935" y1="0.0" x2="146.87752976360935" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
              </line>
              <line x1="205.74627916786085" y1="0.0" x2="205.74627916786085" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
              </line>
              <line x1="264.61502857211417" y1="0.0" x2="264.61502857211417" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
              </line>
              <line x1="323.4837779763657" y1="0.0" x2="323.4837779763657" y2="321.0" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
              </line>
            </g>
          </g>
          <g transform="translate(29.941816366404606 0.0 ) ">
            <g>
              <line x1="0.0" y1="290.01659923845796" x2="382.0581836335954" y2="290.01659923845796" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
              </line>
              <line x1="0.0" y1="226.35643741075683" x2="382.0581836335954" y2="226.35643741075683" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
              </line>
              <line x1="0.0" y1="162.6962755830557" x2="382.0581836335954" y2="162.6962755830557" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
              </line>
              <line x1="0.0" y1="99.03611375535456" x2="382.0581836335954" y2="99.03611375535456" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
              </line>
              <line x1="0.0" y1="35.37595192765343" x2="382.0581836335954" y2="35.37595192765343" stroke="rgb(233,233,233)" stroke-opacity="1.0" stroke-width="1.0" fill="none">
              </line>
            </g>
          </g>
        </g>
        <g clip-path="url(#cwVydbW)" clip-bounds-jfx="[rect (29.941816366404606, 0.0), (382.0581836335954, 321.0)]">
          <g transform="translate(29.941816366404606 0.0 ) ">
            <g>
              <g>
                <g>
                  <path d="M17.366281074255312 306.4090909090909 L17.366281074255312 306.4090909090909 L23.253156014679917 303.0032722513089 L29.14003095510634 298.4197405997144 L35.026905895530945 298.03777962874824 L40.91378083595555 295.5232032365541 L46.80065577638197 292.69032603522123 L52.68753071680658 291.00333174678724 L58.57440565723118 291.1306520704427 L64.4612805976576 285.17842693955265 L70.34815553808221 283.8415635411709 L76.23503047850681 279.83097334602576 L82.12190541893324 275.279271775345 L88.00878035935784 272.4463945740124 L93.89565529978245 269.64534745359356 L99.78253024020887 267.99018324607323 L105.66940518063348 258.3774988100904 L111.55628012105808 258.3774988100904 L117.4431550614845 254.36690861494526 L123.33003000190911 252.93455497382206 L129.2169049423337 246.09108757734407 L135.10377988275832 240.39350309376505 L140.99065482318474 236.41474297953368 L146.87752976360935 230.0487267967635 L152.76440470403395 226.13362684435992 L158.65127964446037 222.05937648738677 L164.53815458488498 216.32996192289397 L170.42502952530958 212.00107091861014 L176.311904465736 207.44936934792963 L182.1987794061606 202.42021656354132 L188.08565434658522 197.0727629700143 L193.97252928701164 190.16563541170876 L199.85940422743624 185.07282246549244 L205.74627916786085 181.88981437410757 L211.63315410828727 176.06490956687276 L217.52002904871188 172.3407900999523 L223.40690398913648 171.86333888624472 L229.2937789295629 167.66176820561645 L235.1806538699875 160.0225487862922 L241.0675288104121 154.13398381722982 L246.95440375083854 151.84221799143256 L252.84127869126314 141.05182056163721 L258.72815363168775 136.81841980009517 L264.61502857211417 132.45769871489756 L270.5019035125388 127.71501665873393 L276.3887784529634 120.36226796763435 L282.2756533933898 111.67265587815336 L288.1625283338144 107.34376487386953 L294.049403274239 99.41807472632081 L299.9362782146636 93.46584959543065 L305.82315315509004 86.81336268443602 L311.71002809551464 81.65688957639213 L317.59690303593925 75.99113517372666 L323.4837779763657 67.55616373155635 L329.3706529167903 62.6225011899096 L335.2575278572149 56.22465492622564 L341.1444027976413 47.21674202760596 L347.0312777380659 38.71811042360787 L352.9181526784905 33.816277962874665 L358.80502761891694 21.05241551642075 L364.69190255934154 14.590909090909008 " fill="none" stroke-width="2.2" stroke="rgb(71,71,71)" stroke-opacity="1.0">
                  </path>
                </g>
              </g>
            </g>
          </g>
          <defs>
            <clippath id="cwVydbW">
              <rect x="29.941816366404606" y="0.0" width="382.0581836335954" height="321.0">
              </rect>
            </clippath>
          </defs>
        </g>
        <g>
          <g transform="translate(29.941816366404606 321.0 ) ">
            <g transform="translate(29.14003095510634 0.0 ) ">
              <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
              </line>
              <g transform="translate(0.0 7.0 ) ">
                <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                  <tspan>1960</tspan>
                </text>
              </g>
            </g>
            <g transform="translate(88.00878035935784 0.0 ) ">
              <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
              </line>
              <g transform="translate(0.0 7.0 ) ">
                <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                  <tspan>1970</tspan>
                </text>
              </g>
            </g>
            <g transform="translate(146.87752976360935 0.0 ) ">
              <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
              </line>
              <g transform="translate(0.0 7.0 ) ">
                <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                  <tspan>1980</tspan>
                </text>
              </g>
            </g>
            <g transform="translate(205.74627916786085 0.0 ) ">
              <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
              </line>
              <g transform="translate(0.0 7.0 ) ">
                <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                  <tspan>1990</tspan>
                </text>
              </g>
            </g>
            <g transform="translate(264.61502857211417 0.0 ) ">
              <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
              </line>
              <g transform="translate(0.0 7.0 ) ">
                <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                  <tspan>2000</tspan>
                </text>
              </g>
            </g>
            <g transform="translate(323.4837779763657 0.0 ) ">
              <line stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" x2="0.0" y2="4.0">
              </line>
              <g transform="translate(0.0 7.0 ) ">
                <text class="axis-text-x" text-anchor="middle" dy="0.7em">
                  <tspan>2010</tspan>
                </text>
              </g>
            </g>
            <line x1="0.0" y1="0.0" x2="382.0581836335954" y2="0.0" stroke-width="1.0" stroke="rgb(71,71,71)" stroke-opacity="1.0">
            </line>
          </g>
          <g transform="translate(29.941816366404606 0.0 ) ">
            <g transform="translate(0.0 290.01659923845796 ) ">
              <g transform="translate(-3.0 0.0 ) ">
                <text class="axis-text-y" text-anchor="end" dy="0.35em">
                  <tspan>320</tspan>
                </text>
              </g>
            </g>
            <g transform="translate(0.0 226.35643741075683 ) ">
              <g transform="translate(-3.0 0.0 ) ">
                <text class="axis-text-y" text-anchor="end" dy="0.35em">
                  <tspan>340</tspan>
                </text>
              </g>
            </g>
            <g transform="translate(0.0 162.6962755830557 ) ">
              <g transform="translate(-3.0 0.0 ) ">
                <text class="axis-text-y" text-anchor="end" dy="0.35em">
                  <tspan>360</tspan>
                </text>
              </g>
            </g>
            <g transform="translate(0.0 99.03611375535456 ) ">
              <g transform="translate(-3.0 0.0 ) ">
                <text class="axis-text-y" text-anchor="end" dy="0.35em">
                  <tspan>380</tspan>
                </text>
              </g>
            </g>
            <g transform="translate(0.0 35.37595192765343 ) ">
              <g transform="translate(-3.0 0.0 ) ">
                <text class="axis-text-y" text-anchor="end" dy="0.35em">
                  <tspan>400</tspan>
                </text>
              </g>
            </g>
          </g>
        </g>
      </g>
      <g transform="translate(59.44181636640461 16.8 ) ">
        <text class="plot-title" y="0.0">
          <tspan>Carbon dioxide emissions</tspan>
        </text>
      </g>
      <g transform="translate(16.0 187.0 ) rotate(-90.0 ) ">
        <text class="axis-title-y" y="0.0" text-anchor="middle">
          <tspan>Trend</tspan>
        </text>
      </g>
      <g transform="translate(250.4709081832023 393.0 ) ">
        <text class="axis-title-x" y="0.0" text-anchor="middle">
          <tspan>Year</tspan>
        </text>
      </g>
      <path fill="rgb(0,0,0)" fill-opacity="0.0" stroke="rgb(71,71,71)" stroke-opacity="1.0" stroke-width="0.0" d="M0.0 0.0 L0.0 400.0 L448.0 400.0 L448.0 0.0 Z" pointer-events="none">
      </path>
    </g>
    <g id="duF5zvT">
    </g>
  </svg>
</svg>
</div>
</div>
<a class="quarto-notebook-link" id="nblink-2" href="labs/Practice/Empirical-preview.html#cell-0">Source: You don't need to use these settings yourself</a></div>
</section>
<section id="practice3-practice3.1" class="level1">
<h1>Practice3-Practice3.1</h1>
<div class="quarto-embed-nb-cell">
<ol type="1">
<li></li>
</ol>
<div id="cell-1" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> textwrap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-2" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>pd.read_csv(</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://vincentarelbundock.github.io/Rdatasets/csv/dplyr/storms.csv"</span>, nrows<span class="op">=</span><span class="dv">10</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">rownames</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">long</th>
<th data-quarto-table-cell-role="th">status</th>
<th data-quarto-table-cell-role="th">category</th>
<th data-quarto-table-cell-role="th">wind</th>
<th data-quarto-table-cell-role="th">pressure</th>
<th data-quarto-table-cell-role="th">tropicalstorm_force_diameter</th>
<th data-quarto-table-cell-role="th">hurricane_force_diameter</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Amy</td>
<td>1975</td>
<td>6</td>
<td>27</td>
<td>0</td>
<td>27.5</td>
<td>-79.0</td>
<td>tropical depression</td>
<td>NaN</td>
<td>25</td>
<td>1013</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>Amy</td>
<td>1975</td>
<td>6</td>
<td>27</td>
<td>6</td>
<td>28.5</td>
<td>-79.0</td>
<td>tropical depression</td>
<td>NaN</td>
<td>25</td>
<td>1013</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>Amy</td>
<td>1975</td>
<td>6</td>
<td>27</td>
<td>12</td>
<td>29.5</td>
<td>-79.0</td>
<td>tropical depression</td>
<td>NaN</td>
<td>25</td>
<td>1013</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>Amy</td>
<td>1975</td>
<td>6</td>
<td>27</td>
<td>18</td>
<td>30.5</td>
<td>-79.0</td>
<td>tropical depression</td>
<td>NaN</td>
<td>25</td>
<td>1013</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>Amy</td>
<td>1975</td>
<td>6</td>
<td>28</td>
<td>0</td>
<td>31.5</td>
<td>-78.8</td>
<td>tropical depression</td>
<td>NaN</td>
<td>25</td>
<td>1012</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>6</td>
<td>Amy</td>
<td>1975</td>
<td>6</td>
<td>28</td>
<td>6</td>
<td>32.4</td>
<td>-78.7</td>
<td>tropical depression</td>
<td>NaN</td>
<td>25</td>
<td>1012</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>7</td>
<td>Amy</td>
<td>1975</td>
<td>6</td>
<td>28</td>
<td>12</td>
<td>33.3</td>
<td>-78.0</td>
<td>tropical depression</td>
<td>NaN</td>
<td>25</td>
<td>1011</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>8</td>
<td>Amy</td>
<td>1975</td>
<td>6</td>
<td>28</td>
<td>18</td>
<td>34.0</td>
<td>-77.0</td>
<td>tropical depression</td>
<td>NaN</td>
<td>30</td>
<td>1006</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>9</td>
<td>Amy</td>
<td>1975</td>
<td>6</td>
<td>29</td>
<td>0</td>
<td>34.4</td>
<td>-75.8</td>
<td>tropical storm</td>
<td>NaN</td>
<td>35</td>
<td>1004</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>10</td>
<td>Amy</td>
<td>1975</td>
<td>6</td>
<td>29</td>
<td>6</td>
<td>34.0</td>
<td>-74.8</td>
<td>tropical storm</td>
<td>NaN</td>
<td>40</td>
<td>1002</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-3" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"https://api.ons.gov.uk/timeseries/JP9Z/dataset/UNEM/data"</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> requests.get(url)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"请求状态码: </span><span class="sc">{</span>response<span class="sc">.</span>status_code<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"返回的原始内容: </span><span class="sc">{</span>response<span class="sc">.</span>text<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="co">#The interface API is no longer available, so I can't get the data at all!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>请求状态码: 404
返回的原始内容: This API is being decommissioned as part of a suite of work to improve the digital products and services we offer. It is planned to be fully retired on 25/11/2024. If you have any queries please contact us at apiservice@ons.gov.uk.
</code></pre>
</div>
</div>
<p>For the above, I made changes to the code. Using the FRED API key, query series_id=“LMJVTTUVGBM647S”, which is the series number of the UK job vacancies (in thousands).167ccd5ae95c579ae64d6b1295c563feThis is Jie Xu’s FRED API KEY</p>
<div id="cell-5" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 替换为你的 FRED API key</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>api_key <span class="op">=</span> <span class="st">"167ccd5ae95c579ae64d6b1295c563fe"</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="ss">f"https://api.stlouisfed.org/fred/series/observations?series_id=LMJVTTUVGBM647S&amp;api_key=</span><span class="sc">{</span>api_key<span class="sc">}</span><span class="ss">&amp;file_type=json"</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> requests.get(url)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> response.json()[<span class="st">'observations'</span>]</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 提取日期和职位空缺数量，过滤掉非数字数据</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>dates <span class="op">=</span> [item[<span class="st">'date'</span>] <span class="cf">for</span> item <span class="kw">in</span> data]</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> []</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> item <span class="kw">in</span> data:</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>        values.append(<span class="bu">float</span>(item[<span class="st">'value'</span>]))</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>        values.append(<span class="va">None</span>)  <span class="co"># 使用 None 表示无效数据</span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建 DataFrame 并去除无效数据</span></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'Date'</span>: dates, <span class="st">'Vacancies'</span>: values})</span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>df.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制折线图</span></span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a>plt.plot(df[<span class="st">'Date'</span>], df[<span class="st">'Vacancies'</span>], label<span class="op">=</span><span class="st">'UK Job Vacancies (Service Industries)'</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Date'</span>)</span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Vacancies (Thousands)'</span>)</span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'UK Job Vacancies (Service Industries)'</span>)</span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="practice_files/figure-html/labs-Practice-Practice3.1-cell-5-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-6" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas_datareader.data <span class="im">as</span> web</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>df_u <span class="op">=</span> web.DataReader(<span class="st">"LRHUTTTTGBM156S"</span>, <span class="st">"fred"</span>)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>df_u.plot(title<span class="op">=</span><span class="st">"UK unemployment (percent)"</span>, legend<span class="op">=</span><span class="va">False</span>, ylim<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">6</span>), lw<span class="op">=</span><span class="fl">3.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="practice_files/figure-html/labs-Practice-Practice3.1-cell-6-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-7" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"https://databank.worldbank.org/source/millennium-development-goals/Series/EN.ATM.CO2E.KT"</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>html <span class="op">=</span> requests.get(url).content</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_html(html)[<span class="dv">0</span>]</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['Indicator', 'Rule', 'Weighted Indicator', '%'], dtype='object')</code></pre>
</div>
</div>
<p>First, I went to Getting Data-Coding for Economists based on the code, but could not get the data. Then, I went to https://datacatalog.worldbank.org/indicator/b66c366b-bdce-eb11-bacc-000d3a596ff0/CO2-emissions–metric-tons-per-capita. this site to get the Data and the page keeps reporting an error: An error occurs. This could be due to</p>
<p>Our network is unusually busy The server is currently unavailable Please try again later or contact data@worldbank.org</p>
<p>Error ID: 9bcb1bcd7bd91946aaddafba37719f72. So I can only use excel sheet.</p>
<div id="cell-9" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 读取Excel文件，假设数据在第一个工作表</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_excel(<span class="st">'data\EN.ATM.CO2E.PC.xlsx'</span>)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 重命名列（如果需要），确保列名与你的要求一致，这里假设原始列名分别为'Country Name'、'Year'、'EN.ATM.CO2E.KT'</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>df.rename(columns<span class="op">=</span>{<span class="st">'Country Name'</span>: <span class="st">'country'</span>, <span class="st">'Year'</span>: <span class="st">'year'</span>, <span class="st">'EN.ATM.CO2E.KT'</span>: <span class="st">'EN.ATM.CO2E.PC'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 选择需要的列并按照人均二氧化碳排放量排序</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>selected_data <span class="op">=</span> df[[<span class="st">'country'</span>, <span class="st">'year'</span>, <span class="st">'EN.ATM.CO2E.PC'</span>]].sort_values(<span class="st">'EN.ATM.CO2E.PC'</span>)</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 显示处理后的数据表格</span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(selected_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   country  year  EN.ATM.CO2E.PC
0                    India  2017        1.704927
1     East Asia\n&amp; Pacific  2017        5.960076
2  Europe &amp;\nCentral\nAsia  2017        6.746232
3                    China  2017        7.226160
4           United\nStates  2017       14.823245</code></pre>
</div>
</div>
<div id="cell-10" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">"country"</span>, y<span class="op">=</span><span class="st">"EN.ATM.CO2E.PC"</span>, data<span class="op">=</span>df.reset_index(), ax<span class="op">=</span>ax)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="vs">r"CO$_2$ (metric tons per capita)"</span>, loc<span class="op">=</span><span class="st">"right"</span>)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">"The USA leads the world on per-capita emissions"</span>, y<span class="op">=</span><span class="fl">1.01</span>)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> key, spine <span class="kw">in</span> ax.spines.items():</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>    spine.set_visible(<span class="va">False</span>)</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">""</span>)</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">""</span>)</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>ax.yaxis.tick_right()</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="practice_files/figure-html/labs-Practice-Practice3.1-cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>For this link: https://stats.oecd.org/SDMX-JSON/data/PDB_LV/GBR+FRA+CAN+ITA+DEU+JPN+USA.T_GDPEMP.CPC/all?startTime=2010 can no longer be found.404 - File or directory not found. The resource you are looking for may have been deleted, renamed, or is temporarily unavailable.</p>
<div id="cell-12" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"http://aeturrell.com/research"</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>page <span class="op">=</span> requests.get(url)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>page.text[:<span class="dv">300</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>'&lt;!DOCTYPE html&gt;\n&lt;html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"&gt;&lt;head&gt;\n\n&lt;meta charset="utf-8"&gt;\n&lt;meta name="generator" content="quarto-1.5.56"&gt;\n\n&lt;meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"&gt;\n\n&lt;meta name="author" content="Arthur Turrell"&gt;\n'</code></pre>
</div>
</div>
<div id="cell-13" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>soup <span class="op">=</span> BeautifulSoup(page.text, <span class="st">"html.parser"</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(soup.prettify()[<span class="dv">60000</span>:<span class="dv">60500</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       &lt;/div&gt;
          &lt;div class="project-category"&gt;
           &lt;a href="#category=gender pay gap"&gt;
            gender pay gap
           &lt;/a&gt;
          &lt;/div&gt;
          &lt;div class="project-category"&gt;
           &lt;a href="#category=labour"&gt;
            labour
           &lt;/a&gt;
          &lt;/div&gt;
          &lt;div class="project-category"&gt;
           &lt;a href="#category=text analysis"&gt;
            text analysis
           &lt;/a&gt;
          &lt;/div&gt;
         &lt;/div&gt;
         &lt;div class="project-details-listing</code></pre>
</div>
</div>
<div id="cell-14" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get all paragraphs</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>all_paras <span class="op">=</span> soup.find_all(<span class="st">"p"</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Just show one of the paras</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>all_paras[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>&lt;p&gt;Botta, Federico, Robin Lovelace, Laura Gilbert, and Arthur Turrell. "Packaging code and data for reproducible research: A case study of journey time statistics." &lt;i&gt;Environment and Planning B: Urban Analytics and City Science&lt;/i&gt; (2024): 23998083241267331. doi: &lt;a href="https://doi.org/10.1177/23998083241267331"&gt;&lt;code&gt;10.1177/23998083241267331&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;</code></pre>
</div>
</div>
<div id="cell-15" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>all_paras[<span class="dv">1</span>].text</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<pre><code>'Botta, Federico, Robin Lovelace, Laura Gilbert, and Arthur Turrell. "Packaging code and data for reproducible research: A case study of journey time statistics." Environment and Planning B: Urban Analytics and City Science (2024): 23998083241267331. doi: 10.1177/23998083241267331'</code></pre>
</div>
</div>
<div id="cell-16" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>projects <span class="op">=</span> soup.find_all(<span class="st">"div"</span>, class_<span class="op">=</span><span class="st">"project-content listing-pub-info"</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>projects <span class="op">=</span> [x.text.strip() <span class="cf">for</span> x <span class="kw">in</span> projects]</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>projects[:<span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>['Botta, Federico, Robin Lovelace, Laura Gilbert, and Arthur Turrell. "Packaging code and data for reproducible research: A case study of journey time statistics." Environment and Planning B: Urban Analytics and City Science (2024): 23998083241267331. doi: 10.1177/23998083241267331',
 'Kalamara, Eleni, Arthur Turrell, Chris Redl, George Kapetanios, and Sujit Kapadia. "Making text count: economic forecasting using newspaper text." Journal of Applied Econometrics 37, no. 5 (2022): 896-919. doi: 10.1002/jae.2907',
 'Turrell, A., Speigner, B., Copple, D., Djumalieva, J. and Thurgood, J., 2021. Is the UK’s productivity puzzle mostly driven by occupational mismatch? An analysis using big data on job vacancies. Labour Economics, 71, p.102013. doi: 10.1016/j.labeco.2021.102013',
 'Haldane, Andrew G., and Arthur E. Turrell. "Drawing on different disciplines: macroeconomic agent-based models." Journal of Evolutionary Economics 29 (2019): 39-66. doi: 10.1007/s00191-018-0557-5']</code></pre>
</div>
</div>
<div id="cell-17" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> scraper(url):</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>        response <span class="op">=</span> requests.get(url)</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>        response.raise_for_status()  <span class="co"># 检查请求是否成功，若不成功则抛出异常</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>        soup <span class="op">=</span> BeautifulSoup(response.text, <span class="st">'html.parser'</span>)</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> soup.title.string <span class="cf">if</span> soup.title <span class="cf">else</span> <span class="st">"No title found"</span></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> requests.RequestException <span class="im">as</span> e:</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Error fetching page </span><span class="sc">{</span>url<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>start, stop <span class="op">=</span> <span class="dv">0</span>, <span class="dv">50</span></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>root_url <span class="op">=</span> <span class="st">"www.codingforeconomists.com/page="</span></span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>info_on_pages <span class="op">=</span> []</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(start, stop):</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>    url <span class="op">=</span> root_url <span class="op">+</span> <span class="bu">str</span>(i)</span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>    info <span class="op">=</span> scraper(url)</span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>    info_on_pages.append(info)</span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(info_on_pages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Error fetching page www.codingforeconomists.com/page=0: Invalid URL 'www.codingforeconomists.com/page=0': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=0?
Error fetching page www.codingforeconomists.com/page=1: Invalid URL 'www.codingforeconomists.com/page=1': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=1?
Error fetching page www.codingforeconomists.com/page=2: Invalid URL 'www.codingforeconomists.com/page=2': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=2?
Error fetching page www.codingforeconomists.com/page=3: Invalid URL 'www.codingforeconomists.com/page=3': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=3?
Error fetching page www.codingforeconomists.com/page=4: Invalid URL 'www.codingforeconomists.com/page=4': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=4?
Error fetching page www.codingforeconomists.com/page=5: Invalid URL 'www.codingforeconomists.com/page=5': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=5?
Error fetching page www.codingforeconomists.com/page=6: Invalid URL 'www.codingforeconomists.com/page=6': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=6?
Error fetching page www.codingforeconomists.com/page=7: Invalid URL 'www.codingforeconomists.com/page=7': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=7?
Error fetching page www.codingforeconomists.com/page=8: Invalid URL 'www.codingforeconomists.com/page=8': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=8?
Error fetching page www.codingforeconomists.com/page=9: Invalid URL 'www.codingforeconomists.com/page=9': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=9?
Error fetching page www.codingforeconomists.com/page=10: Invalid URL 'www.codingforeconomists.com/page=10': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=10?
Error fetching page www.codingforeconomists.com/page=11: Invalid URL 'www.codingforeconomists.com/page=11': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=11?
Error fetching page www.codingforeconomists.com/page=12: Invalid URL 'www.codingforeconomists.com/page=12': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=12?
Error fetching page www.codingforeconomists.com/page=13: Invalid URL 'www.codingforeconomists.com/page=13': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=13?
Error fetching page www.codingforeconomists.com/page=14: Invalid URL 'www.codingforeconomists.com/page=14': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=14?
Error fetching page www.codingforeconomists.com/page=15: Invalid URL 'www.codingforeconomists.com/page=15': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=15?
Error fetching page www.codingforeconomists.com/page=16: Invalid URL 'www.codingforeconomists.com/page=16': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=16?
Error fetching page www.codingforeconomists.com/page=17: Invalid URL 'www.codingforeconomists.com/page=17': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=17?
Error fetching page www.codingforeconomists.com/page=18: Invalid URL 'www.codingforeconomists.com/page=18': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=18?
Error fetching page www.codingforeconomists.com/page=19: Invalid URL 'www.codingforeconomists.com/page=19': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=19?
Error fetching page www.codingforeconomists.com/page=20: Invalid URL 'www.codingforeconomists.com/page=20': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=20?
Error fetching page www.codingforeconomists.com/page=21: Invalid URL 'www.codingforeconomists.com/page=21': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=21?
Error fetching page www.codingforeconomists.com/page=22: Invalid URL 'www.codingforeconomists.com/page=22': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=22?
Error fetching page www.codingforeconomists.com/page=23: Invalid URL 'www.codingforeconomists.com/page=23': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=23?
Error fetching page www.codingforeconomists.com/page=24: Invalid URL 'www.codingforeconomists.com/page=24': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=24?
Error fetching page www.codingforeconomists.com/page=25: Invalid URL 'www.codingforeconomists.com/page=25': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=25?
Error fetching page www.codingforeconomists.com/page=26: Invalid URL 'www.codingforeconomists.com/page=26': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=26?
Error fetching page www.codingforeconomists.com/page=27: Invalid URL 'www.codingforeconomists.com/page=27': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=27?
Error fetching page www.codingforeconomists.com/page=28: Invalid URL 'www.codingforeconomists.com/page=28': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=28?
Error fetching page www.codingforeconomists.com/page=29: Invalid URL 'www.codingforeconomists.com/page=29': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=29?
Error fetching page www.codingforeconomists.com/page=30: Invalid URL 'www.codingforeconomists.com/page=30': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=30?
Error fetching page www.codingforeconomists.com/page=31: Invalid URL 'www.codingforeconomists.com/page=31': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=31?
Error fetching page www.codingforeconomists.com/page=32: Invalid URL 'www.codingforeconomists.com/page=32': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=32?
Error fetching page www.codingforeconomists.com/page=33: Invalid URL 'www.codingforeconomists.com/page=33': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=33?
Error fetching page www.codingforeconomists.com/page=34: Invalid URL 'www.codingforeconomists.com/page=34': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=34?
Error fetching page www.codingforeconomists.com/page=35: Invalid URL 'www.codingforeconomists.com/page=35': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=35?
Error fetching page www.codingforeconomists.com/page=36: Invalid URL 'www.codingforeconomists.com/page=36': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=36?
Error fetching page www.codingforeconomists.com/page=37: Invalid URL 'www.codingforeconomists.com/page=37': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=37?
Error fetching page www.codingforeconomists.com/page=38: Invalid URL 'www.codingforeconomists.com/page=38': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=38?
Error fetching page www.codingforeconomists.com/page=39: Invalid URL 'www.codingforeconomists.com/page=39': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=39?
Error fetching page www.codingforeconomists.com/page=40: Invalid URL 'www.codingforeconomists.com/page=40': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=40?
Error fetching page www.codingforeconomists.com/page=41: Invalid URL 'www.codingforeconomists.com/page=41': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=41?
Error fetching page www.codingforeconomists.com/page=42: Invalid URL 'www.codingforeconomists.com/page=42': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=42?
Error fetching page www.codingforeconomists.com/page=43: Invalid URL 'www.codingforeconomists.com/page=43': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=43?
Error fetching page www.codingforeconomists.com/page=44: Invalid URL 'www.codingforeconomists.com/page=44': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=44?
Error fetching page www.codingforeconomists.com/page=45: Invalid URL 'www.codingforeconomists.com/page=45': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=45?
Error fetching page www.codingforeconomists.com/page=46: Invalid URL 'www.codingforeconomists.com/page=46': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=46?
Error fetching page www.codingforeconomists.com/page=47: Invalid URL 'www.codingforeconomists.com/page=47': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=47?
Error fetching page www.codingforeconomists.com/page=48: Invalid URL 'www.codingforeconomists.com/page=48': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=48?
Error fetching page www.codingforeconomists.com/page=49: Invalid URL 'www.codingforeconomists.com/page=49': No scheme supplied. Perhaps you meant https://www.codingforeconomists.com/page=49?
[None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None]</code></pre>
</div>
</div>
<div id="cell-18" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>df_list <span class="op">=</span> pd.read_html(</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://simple.wikipedia.org/wiki/FIFA_World_Cup"</span>, match<span class="op">=</span><span class="st">"Sweden"</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve first and only entry from list of dataframes</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df_list[<span class="dv">0</span>]</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Years</th>
<th data-quarto-table-cell-role="th">Hosts</th>
<th data-quarto-table-cell-role="th">Winners</th>
<th data-quarto-table-cell-role="th">Score</th>
<th data-quarto-table-cell-role="th">Runner's-up</th>
<th data-quarto-table-cell-role="th">Third place</th>
<th data-quarto-table-cell-role="th">Score.1</th>
<th data-quarto-table-cell-role="th">Fourth place</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1930 Details</td>
<td>Uruguay</td>
<td>Uruguay</td>
<td>4 - 2</td>
<td>Argentina</td>
<td>United States</td>
<td>[note 1]</td>
<td>Yugoslavia</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1934 Details</td>
<td>Italy</td>
<td>Italy</td>
<td>2 - 1</td>
<td>Czechoslovakia</td>
<td>Germany</td>
<td>3 - 2</td>
<td>Austria</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1938 Details</td>
<td>France</td>
<td>Italy</td>
<td>4 - 2</td>
<td>Hungary</td>
<td>Brazil</td>
<td>4 - 2</td>
<td>Sweden</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1950 Details</td>
<td>Brazil</td>
<td>Uruguay</td>
<td>2 - 1</td>
<td>Brazil</td>
<td>Sweden</td>
<td>[note 2]</td>
<td>Spain</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1954 Details</td>
<td>Switzerland</td>
<td>West Germany</td>
<td>3 - 2</td>
<td>Hungary</td>
<td>Austria</td>
<td>3 - 1</td>
<td>Uruguay</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>pdf part</p>
<div id="cell-20" class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> PyPDF2</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_pdf_text(file_path):</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> <span class="st">""</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(file_path, <span class="st">'rb'</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>        reader <span class="op">=</span> PyPDF2.PdfReader(<span class="bu">file</span>)</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> page <span class="kw">in</span> reader.pages:</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>            text <span class="op">+=</span> page.extract_text()</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> text</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>pdf_file_path <span class="op">=</span> Path(<span class="st">"D:</span><span class="ch">\360</span><span class="st">MoveData\Users</span><span class="ch">\75</span><span class="st">903\Desktop\SuYibo-Homework\data\pdf_with_table.pdf"</span>)</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>pdf_text <span class="op">=</span> read_pdf_text(pdf_file_path)</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pdf_text[:<span class="dv">220</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3 
 2 Quantifying Fuel -Saving Opportunit ies from Specific Driving 
Behavior Changes  
2.1 Savings from Improving Individual Driving  Profiles  
2.1.1  Drive Profile Subsample from Real -World Travel Survey  
The interi</code></pre>
</div>
</div>
<div id="cell-21" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tabula</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置 PDF 文件路径</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>pdf_path <span class="op">=</span> os.path.join(<span class="st">'data'</span>, <span class="st">'pdf_with_table.pdf'</span>)</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 tabula 读取 PDF 中的表格数据</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>tables <span class="op">=</span> tabula.read_pdf(pdf_path, pages<span class="op">=</span><span class="st">'all'</span>)</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 打印第一个表格的数据（你可以根据实际需求修改处理方式）</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">len</span>(tables) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(tables[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Unnamed: 0 Unnamed: 1 Unnamed: 2 Unnamed: 3 Percent Fuel Savings Unnamed: 4
0      Cycle         KI   Distance        NaN                  NaN        NaN
1       Name     (1/km)       (mi)   Improved  Decreased Eliminate  Decreased
2        NaN        NaN        NaN      Speed          Accel Stops       Idle
3     2012_2       3.30        1.3       5.9%           9.5% 29.2%      17.4%
4     2145_1       0.68       11.2       2.4%            0.1% 9.5%       2.7%
5     4234_1       0.59       58.7       8.5%            1.3% 8.5%       3.3%
6     2032_2       0.17       57.8      21.7%            0.3% 2.7%       1.2%
7     4171_1       0.07      173.9      58.1%            1.6% 2.1%       0.5%</code></pre>
</div>
</div>
<a class="quarto-notebook-link" id="nblink-3" href="labs/Practice/Practice3.1-preview.html#cell-0">Source: 替换为你的 FRED API key</a></div>
</section>
<section id="practice3-practice3.2" class="level1">
<h1>Practice3-Practice3.2</h1>
<div class="quarto-embed-nb-cell">
<p>2</p>
<div id="cell-1" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> time <span class="im">import</span> sleep</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Downloading imdb top 250 movie's data</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">'http://www.imdb.com/chart/top'</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> requests.get(url)</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>soup <span class="op">=</span> BeautifulSoup(response.text, <span class="st">"html.parser"</span>)</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>movies <span class="op">=</span> soup.select(<span class="st">'li.ipc-metadata-list-summary-item'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-2" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>crew <span class="op">=</span> [a.attrs.get(<span class="st">'title'</span>) <span class="cf">for</span> a <span class="kw">in</span> soup.select(<span class="st">'td.titleColumn a'</span>)]</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>ratings <span class="op">=</span> [b.attrs.get(<span class="st">'data-value'</span>)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> b <span class="kw">in</span> soup.select(<span class="st">'td.posterColumn span[name=ir]'</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-3" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="co"># movie information</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span> <span class="op">=</span> []</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterating over movies to extract</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="co"># each movie's details</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(movies)):</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Separating movie into: 'place',</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 'title', 'year'</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>    movie_string <span class="op">=</span> movies[index].get_text()</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>    movie <span class="op">=</span> (<span class="st">' '</span>.join(movie_string.split()).replace(<span class="st">'.'</span>, <span class="st">''</span>))</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>    movie_title <span class="op">=</span> movie[<span class="bu">len</span>(<span class="bu">str</span>(index))<span class="op">+</span><span class="dv">1</span>:<span class="op">-</span><span class="dv">7</span>]</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>    year <span class="op">=</span> re.search(<span class="st">'\((.*?)\)'</span>, movie_string).group(<span class="dv">1</span>)</span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>    place <span class="op">=</span> movie[:<span class="bu">len</span>(<span class="bu">str</span>(index))<span class="op">-</span>(<span class="bu">len</span>(movie))]</span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> {<span class="st">"place"</span>: place,</span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">"movie_title"</span>: movie_title,</span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">"rating"</span>: ratings[index],</span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">"year"</span>: year,</span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">"star_cast"</span>: crew[index],</span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">list</span>.append(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-4" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> movie <span class="kw">in</span> <span class="bu">list</span>:</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(movie[<span class="st">'place'</span>], <span class="st">'-'</span>, movie[<span class="st">'movie_title'</span>], <span class="st">'('</span><span class="op">+</span>movie[<span class="st">'year'</span>] <span class="op">+</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">') -'</span>, <span class="st">'Starring:'</span>, movie[<span class="st">'star_cast'</span>], movie[<span class="st">'rating'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-5" class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co">#saving the list as dataframe</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="co">#then converting into .csv file</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(<span class="bu">list</span>)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>df.to_csv(<span class="st">'D:</span><span class="ch">\360</span><span class="st">MoveData\Users</span><span class="ch">\75</span><span class="st">903\Desktop\SuYibo-Homework\data\imdb_top_250_movies.csv'</span>,index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<a class="quarto-notebook-link" id="nblink-4" href="labs/Practice/Practice3.2-preview.html#cell-0">Source: Downloading imdb top 250 movie's data</a></div>
</section>
<section id="practice3-practice3.3" class="level1">
<h1>Practice3-Practice3.3</h1>
<div class="quarto-embed-nb-cell">
<ol start="3" type="1">
<li></li>
</ol>
<div id="cell-1" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 定义请求的 URL 和 headers</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"https://movie.douban.com/top250"</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>headers <span class="op">=</span> {</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"User-Agent"</span>: <span class="st">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36"</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 发送 GET 请求</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> requests.get(url, headers<span class="op">=</span>headers)</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>response.encoding <span class="op">=</span> <span class="st">'utf-8'</span>  <span class="co"># 设置编码方式</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>html_content <span class="op">=</span> response.text  <span class="co"># 获取网页的 HTML 内容</span></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"网页内容加载成功！"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>网页内容加载成功！</code></pre>
</div>
</div>
<div id="cell-2" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 Beautiful Soup 解析 HTML</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>soup <span class="op">=</span> BeautifulSoup(html_content, <span class="st">'html.parser'</span>)</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 提取电影名称、描述、评分和评价人数</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>movies <span class="op">=</span> []</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> item <span class="kw">in</span> soup.find_all(<span class="st">'div'</span>, class_<span class="op">=</span><span class="st">'item'</span>):</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> item.find(<span class="st">'span'</span>, class_<span class="op">=</span><span class="st">'title'</span>).get_text()  <span class="co"># 电影名称</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>    description <span class="op">=</span> item.find(<span class="st">'span'</span>, class_<span class="op">=</span><span class="st">'inq'</span>)  <span class="co"># 电影描述</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>    rating <span class="op">=</span> item.find(<span class="st">'span'</span>, class_<span class="op">=</span><span class="st">'rating_num'</span>).get_text()  <span class="co"># 评分</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>    votes <span class="op">=</span> item.find(<span class="st">'div'</span>, class_<span class="op">=</span><span class="st">'star'</span>).find_all(<span class="st">'span'</span>)[<span class="dv">3</span>].get_text()  <span class="co"># 评价人数</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 如果没有描述，将其置为空字符串</span></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> description:</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>        description <span class="op">=</span> description.get_text()</span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>        description <span class="op">=</span> <span class="st">''</span></span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a>    movie <span class="op">=</span> {</span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"title"</span>: title,</span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"description"</span>: description,</span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">"rating"</span>: rating,</span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">"votes"</span>: votes.replace(<span class="st">'人评价'</span>, <span class="st">''</span>).strip()</span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a>    movies.append(movie)</span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb104-28"><a href="#cb104-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"数据提取成功！"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>数据提取成功！</code></pre>
</div>
</div>
<div id="cell-3" class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> csv</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 将数据保存到 CSV 文件</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">'D:</span><span class="ch">\360</span><span class="st">MoveData\Users</span><span class="ch">\75</span><span class="st">903\Desktop\SuYibo-Homework\data\douban_top250.csv'</span>, <span class="st">'w'</span>, newline<span class="op">=</span><span class="st">''</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> csvfile:</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>    fieldnames <span class="op">=</span> [<span class="st">'title'</span>, <span class="st">'description'</span>, <span class="st">'rating'</span>, <span class="st">'votes'</span>]</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>    writer <span class="op">=</span> csv.DictWriter(csvfile, fieldnames<span class="op">=</span>fieldnames)</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>    writer.writeheader()  <span class="co"># 写入表头</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> movie <span class="kw">in</span> movies:</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>        writer.writerow(movie)  <span class="co"># 写入每一行数据</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"数据已成功保存到 D:</span><span class="ch">\360</span><span class="st">MoveData\Users</span><span class="ch">\75</span><span class="st">903\Desktop\SuYibo-Homework\data\douban_top250.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>数据已成功保存到 data\douban_top250.csv</code></pre>
</div>
</div>
<div id="cell-4" class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'D:</span><span class="ch">\360</span><span class="st">MoveData\Users</span><span class="ch">\75</span><span class="st">903\Desktop\SuYibo-Homework\data\douban_top250.csv'</span>)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="co"># show</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        title                      description  rating    votes
0      肖申克的救赎                          希望让人自由。     9.7  3086743
1        霸王别姬                            风华绝代。     9.6  2278421
2        阿甘正传                        一部美国近现代史。     9.5  2297780
3       泰坦尼克号                       失去的才是永恒的。      9.5  2338435
4        千与千寻                  最好的宫崎骏，最好的久石让。      9.4  2386813
5        美丽人生                           最美的谎言。     9.5  1404250
6     这个杀手不太冷                  怪蜀黍和小萝莉不得不说的故事。     9.4  2434726
7        星际穿越            爱是一种力量，让我们超越时空感知它的存在。     9.4  2010081
8        盗梦空间                  诺兰给了我们一场无法盗取的梦。     9.4  2197475
9       楚门的世界            如果再也不能见到你，祝你早安，午安，晚安。     9.4  1868113
10     辛德勒的名单                  拯救一个人，就是拯救整个世界。     9.5  1187176
11    忠犬八公的故事                    永远都不能忘记你所爱的人。     9.4  1469596
12      海上钢琴师        每个人都要走一条自己坚定了的路，就算是粉身碎骨。      9.3  1780067
13    三傻大闹宝莱坞                   英俊版憨豆，高情商版谢耳朵。     9.2  1967345
14     放牛班的春天              天籁一般的童声，是最接近上帝的存在。      9.3  1395330
15     机器人总动员                         小瓦力，大人生。     9.3  1400496
16      疯狂动物城  迪士尼给我们营造的乌托邦就是这样，永远善良勇敢，永远出乎意料。     9.2  2096015
17        无间道                   香港电影史上永不过时的杰作。     9.3  1467474
18       控方证人                       比利·怀德满分作品。     9.6   640164
19  大话西游之大圣娶亲                            一生所爱。     9.2  1621517
20         熔炉     我们一路奋战不是为了改变世界，而是为了不让世界改变我们。     9.3   986933
21         教父            千万不要记恨你的对手，这样会让你失去理智。     9.3  1037883
22       触不可及                       满满温情的高雅喜剧。     9.3  1208935
23      寻梦环游记              死亡不是真的逝去，遗忘才是永恒的消亡。     9.1  1823049
24     当幸福来敲门                          平民励志片。      9.2  1606700</code></pre>
</div>
</div>
<a class="quarto-notebook-link" id="nblink-5" href="labs/Practice/Practice3.3-preview.html#cell-0">Source: 定义请求的 URL 和 headers</a></div>
</section>
<section id="practice4-practice4" class="level1">
<h1>Practice4-Practice4</h1>
<div class="quarto-embed-nb-cell">
<div id="cell-0" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re  </span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> urllib.request, urllib.error  <span class="co"># certain URL</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xlwt  <span class="co"># excel operation</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>    baseurl <span class="op">=</span> <span class="st">"https://movie.douban.com/top250?start="</span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>    datalist <span class="op">=</span> getdata(baseurl)</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>    savepath <span class="op">=</span> <span class="st">".</span><span class="ch">\\</span><span class="st">douban_top250.csv"</span></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>    savedata(datalist, savepath)</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a><span class="co"># compile返回的是匹配到的模式对象</span></span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>findLink <span class="op">=</span> re.<span class="bu">compile</span>(<span class="vs">r'&lt;a href="(.*?)"&gt;'</span>)  <span class="co"># detail</span></span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>findImgSrc <span class="op">=</span> re.<span class="bu">compile</span>(<span class="vs">r'&lt;img.*src="(.*?)"'</span>, re.S)  <span class="co"># re.S  message of picture</span></span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>findTitle <span class="op">=</span> re.<span class="bu">compile</span>(<span class="vs">r'&lt;span class="title"&gt;(.*)&lt;/span&gt;'</span>)  <span class="co"># name </span></span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>findRating <span class="op">=</span> re.<span class="bu">compile</span>(<span class="vs">r'&lt;span class="rating_num" property="v:average"&gt;(.*)&lt;/span&gt;'</span>)  <span class="co"># score</span></span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>findJudge <span class="op">=</span> re.<span class="bu">compile</span>(<span class="vs">r'&lt;span&gt;(\d*)人评价&lt;/span&gt;'</span>)  <span class="co"># number</span></span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>findInq <span class="op">=</span> re.<span class="bu">compile</span>(<span class="vs">r'&lt;span class="inq"&gt;(.*)&lt;/span&gt;'</span>)  <span class="co"># about</span></span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>findBd <span class="op">=</span> re.<span class="bu">compile</span>(<span class="vs">r'&lt;p class=""&gt;(.*?)&lt;/p&gt;'</span>, re.S)  <span class="co"># actor..</span></span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true" tabindex="-1"></a><span class="co">##获取网页数据</span></span>
<span id="cb110-25"><a href="#cb110-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> getdata(baseurl):</span>
<span id="cb110-26"><a href="#cb110-26" aria-hidden="true" tabindex="-1"></a>    datalist <span class="op">=</span> []</span>
<span id="cb110-27"><a href="#cb110-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">10</span>):</span>
<span id="cb110-28"><a href="#cb110-28" aria-hidden="true" tabindex="-1"></a>        url <span class="op">=</span> baseurl <span class="op">+</span> <span class="bu">str</span>(i <span class="op">*</span> <span class="dv">25</span>)  <span class="co">##move on next page</span></span>
<span id="cb110-29"><a href="#cb110-29" aria-hidden="true" tabindex="-1"></a>        html <span class="op">=</span> geturl(url)</span>
<span id="cb110-30"><a href="#cb110-30" aria-hidden="true" tabindex="-1"></a>        soup <span class="op">=</span> BeautifulSoup(html, <span class="st">"html.parser"</span>)  <span class="co">#  BeautifulSoup soup，html</span></span>
<span id="cb110-31"><a href="#cb110-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> item <span class="kw">in</span> soup.find_all(<span class="st">"div"</span>, class_<span class="op">=</span><span class="st">'item'</span>):  <span class="co">##find_all </span></span>
<span id="cb110-32"><a href="#cb110-32" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> []  <span class="co"># save HTML </span></span>
<span id="cb110-33"><a href="#cb110-33" aria-hidden="true" tabindex="-1"></a>            item <span class="op">=</span> <span class="bu">str</span>(item)  <span class="co">##trans</span></span>
<span id="cb110-34"><a href="#cb110-34" aria-hidden="true" tabindex="-1"></a>            link <span class="op">=</span> re.findall(findLink, item)[<span class="dv">0</span>]  </span>
<span id="cb110-35"><a href="#cb110-35" aria-hidden="true" tabindex="-1"></a>            data.append(link)</span>
<span id="cb110-36"><a href="#cb110-36" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb110-37"><a href="#cb110-37" aria-hidden="true" tabindex="-1"></a>            imgSrc <span class="op">=</span> re.findall(findImgSrc, item)[<span class="dv">0</span>]</span>
<span id="cb110-38"><a href="#cb110-38" aria-hidden="true" tabindex="-1"></a>            data.append(imgSrc)</span>
<span id="cb110-39"><a href="#cb110-39" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb110-40"><a href="#cb110-40" aria-hidden="true" tabindex="-1"></a>            titles <span class="op">=</span> re.findall(findTitle, item)  <span class="co">##en zh transla</span></span>
<span id="cb110-41"><a href="#cb110-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="bu">len</span>(titles) <span class="op">==</span> <span class="dv">2</span>):</span>
<span id="cb110-42"><a href="#cb110-42" aria-hidden="true" tabindex="-1"></a>                onetitle <span class="op">=</span> titles[<span class="dv">0</span>]</span>
<span id="cb110-43"><a href="#cb110-43" aria-hidden="true" tabindex="-1"></a>                data.append(onetitle)</span>
<span id="cb110-44"><a href="#cb110-44" aria-hidden="true" tabindex="-1"></a>                twotitle <span class="op">=</span> titles[<span class="dv">1</span>].replace(<span class="st">"/"</span>, <span class="st">""</span>)  <span class="co"># can</span></span>
<span id="cb110-45"><a href="#cb110-45" aria-hidden="true" tabindex="-1"></a>                data.append(twotitle)</span>
<span id="cb110-46"><a href="#cb110-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb110-47"><a href="#cb110-47" aria-hidden="true" tabindex="-1"></a>                data.append(titles)</span>
<span id="cb110-48"><a href="#cb110-48" aria-hidden="true" tabindex="-1"></a>                data.append(<span class="st">" "</span>)  <span class="co">##value</span></span>
<span id="cb110-49"><a href="#cb110-49" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb110-50"><a href="#cb110-50" aria-hidden="true" tabindex="-1"></a>            rating <span class="op">=</span> re.findall(findRating, item)[<span class="dv">0</span>]  <span class="co"># add score</span></span>
<span id="cb110-51"><a href="#cb110-51" aria-hidden="true" tabindex="-1"></a>            data.append(rating)</span>
<span id="cb110-52"><a href="#cb110-52" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb110-53"><a href="#cb110-53" aria-hidden="true" tabindex="-1"></a>            judgeNum <span class="op">=</span> re.findall(findJudge, item)[<span class="dv">0</span>]  <span class="co"># add number</span></span>
<span id="cb110-54"><a href="#cb110-54" aria-hidden="true" tabindex="-1"></a>            data.append(judgeNum)</span>
<span id="cb110-55"><a href="#cb110-55" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb110-56"><a href="#cb110-56" aria-hidden="true" tabindex="-1"></a>            inq <span class="op">=</span> re.findall(findInq, item)  <span class="co"># add abut</span></span>
<span id="cb110-57"><a href="#cb110-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(inq) <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb110-58"><a href="#cb110-58" aria-hidden="true" tabindex="-1"></a>                inq <span class="op">=</span> inq[<span class="dv">0</span>].replace(<span class="st">"。"</span>, <span class="st">""</span>)</span>
<span id="cb110-59"><a href="#cb110-59" aria-hidden="true" tabindex="-1"></a>                data.append(inq)</span>
<span id="cb110-60"><a href="#cb110-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb110-61"><a href="#cb110-61" aria-hidden="true" tabindex="-1"></a>                data.append(<span class="st">" "</span>)</span>
<span id="cb110-62"><a href="#cb110-62" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb110-63"><a href="#cb110-63" aria-hidden="true" tabindex="-1"></a>            bd <span class="op">=</span> re.findall(findBd, item)[<span class="dv">0</span>]</span>
<span id="cb110-64"><a href="#cb110-64" aria-hidden="true" tabindex="-1"></a>            bd <span class="op">=</span> re.sub(<span class="st">'&lt;br(\s+)?/&gt;(\s+)?'</span>, <span class="st">" "</span>, bd)</span>
<span id="cb110-65"><a href="#cb110-65" aria-hidden="true" tabindex="-1"></a>            bd <span class="op">=</span> re.sub(<span class="st">'/'</span>, <span class="st">" "</span>, bd)</span>
<span id="cb110-66"><a href="#cb110-66" aria-hidden="true" tabindex="-1"></a>            data.append(bd.strip())  <span class="co"># cancel</span></span>
<span id="cb110-67"><a href="#cb110-67" aria-hidden="true" tabindex="-1"></a>            datalist.append(data)</span>
<span id="cb110-68"><a href="#cb110-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> datalist</span>
<span id="cb110-69"><a href="#cb110-69" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb110-70"><a href="#cb110-70" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb110-71"><a href="#cb110-71" aria-hidden="true" tabindex="-1"></a><span class="co">##保存数据</span></span>
<span id="cb110-72"><a href="#cb110-72" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> savedata(datalist, savepath):</span>
<span id="cb110-73"><a href="#cb110-73" aria-hidden="true" tabindex="-1"></a>    workbook <span class="op">=</span> xlwt.Workbook(encoding<span class="op">=</span><span class="st">"utf-8"</span>, style_compression<span class="op">=</span><span class="dv">0</span>)  <span class="co">##style_compression=0</span></span>
<span id="cb110-74"><a href="#cb110-74" aria-hidden="true" tabindex="-1"></a>    worksheet <span class="op">=</span> workbook.add_sheet(<span class="st">"douban_top250"</span>, cell_overwrite_ok<span class="op">=</span><span class="va">True</span>)  <span class="co"># cell_overwrite_ok=True</span></span>
<span id="cb110-75"><a href="#cb110-75" aria-hidden="true" tabindex="-1"></a>    column <span class="op">=</span> (<span class="st">"电影详情链接"</span>, <span class="st">"图片链接"</span>, <span class="st">"影片中文名"</span>, <span class="st">"影片外国名"</span>, <span class="st">"评分"</span>, <span class="st">"评价数"</span>, <span class="st">"概况"</span>, <span class="st">"相关信息"</span>)  <span class="co">##execl</span></span>
<span id="cb110-76"><a href="#cb110-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">8</span>):</span>
<span id="cb110-77"><a href="#cb110-77" aria-hidden="true" tabindex="-1"></a>        worksheet.write(<span class="dv">0</span>, i, column[i])  <span class="co"># 将column[i] save [0]</span></span>
<span id="cb110-78"><a href="#cb110-78" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">250</span>):</span>
<span id="cb110-79"><a href="#cb110-79" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> datalist[i]</span>
<span id="cb110-80"><a href="#cb110-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">8</span>):</span>
<span id="cb110-81"><a href="#cb110-81" aria-hidden="true" tabindex="-1"></a>            worksheet.write(i <span class="op">+</span> <span class="dv">1</span>, j, data[j])</span>
<span id="cb110-82"><a href="#cb110-82" aria-hidden="true" tabindex="-1"></a>    workbook.save(savepath)</span>
<span id="cb110-83"><a href="#cb110-83" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb110-84"><a href="#cb110-84" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb110-85"><a href="#cb110-85" aria-hidden="true" tabindex="-1"></a><span class="co">##爬取网页</span></span>
<span id="cb110-86"><a href="#cb110-86" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> geturl(url):</span>
<span id="cb110-87"><a href="#cb110-87" aria-hidden="true" tabindex="-1"></a>    head <span class="op">=</span> {</span>
<span id="cb110-88"><a href="#cb110-88" aria-hidden="true" tabindex="-1"></a>        <span class="st">"User-Agent"</span>: <span class="st">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) "</span></span>
<span id="cb110-89"><a href="#cb110-89" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36"</span></span>
<span id="cb110-90"><a href="#cb110-90" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb110-91"><a href="#cb110-91" aria-hidden="true" tabindex="-1"></a>    req <span class="op">=</span> urllib.request.Request(url, headers<span class="op">=</span>head)</span>
<span id="cb110-92"><a href="#cb110-92" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:  <span class="co">## check error</span></span>
<span id="cb110-93"><a href="#cb110-93" aria-hidden="true" tabindex="-1"></a>        response <span class="op">=</span> urllib.request.urlopen(req)</span>
<span id="cb110-94"><a href="#cb110-94" aria-hidden="true" tabindex="-1"></a>        html <span class="op">=</span> response.read().decode(<span class="st">"utf-8"</span>)</span>
<span id="cb110-95"><a href="#cb110-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> urllib.error.URLError <span class="im">as</span> e:</span>
<span id="cb110-96"><a href="#cb110-96" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">hasattr</span>(e, <span class="st">"code"</span>):  </span>
<span id="cb110-97"><a href="#cb110-97" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(e.code)</span>
<span id="cb110-98"><a href="#cb110-98" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">hasattr</span>(e, <span class="st">"reason"</span>):</span>
<span id="cb110-99"><a href="#cb110-99" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(e.reason)</span>
<span id="cb110-100"><a href="#cb110-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> html</span>
<span id="cb110-101"><a href="#cb110-101" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb110-102"><a href="#cb110-102" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb110-103"><a href="#cb110-103" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">'__main__'</span>:</span>
<span id="cb110-104"><a href="#cb110-104" aria-hidden="true" tabindex="-1"></a>    main()</span>
<span id="cb110-105"><a href="#cb110-105" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"爬取成功！！！"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>爬取成功！！！</code></pre>
</div>
</div>
<div id="cell-1" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> urllib.request, urllib.error  <span class="co"># for URL requests</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> csv  <span class="co"># for saving as CSV</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>    baseurl <span class="op">=</span> <span class="st">"https://movie.douban.com/top250?start="</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>    datalist <span class="op">=</span> getdata(baseurl)</span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>    savepath <span class="op">=</span> <span class="st">"./douban_top250.csv"</span></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>    savedata(datalist, savepath)</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Regular expressions to extract information</span></span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>findLink <span class="op">=</span> re.<span class="bu">compile</span>(<span class="vs">r'&lt;a href="(.*?)"&gt;'</span>)  <span class="co"># detail link</span></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>findImgSrc <span class="op">=</span> re.<span class="bu">compile</span>(<span class="vs">r'&lt;img.*src="(.*?)"'</span>, re.S)  <span class="co"># image link</span></span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>findTitle <span class="op">=</span> re.<span class="bu">compile</span>(<span class="vs">r'&lt;span class="title"&gt;(.*)&lt;/span&gt;'</span>)  <span class="co"># movie title</span></span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a>findRating <span class="op">=</span> re.<span class="bu">compile</span>(<span class="vs">r'&lt;span class="rating_num" property="v:average"&gt;(.*)&lt;/span&gt;'</span>)  <span class="co"># rating</span></span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a>findJudge <span class="op">=</span> re.<span class="bu">compile</span>(<span class="vs">r'&lt;span&gt;(\d*)人评价&lt;/span&gt;'</span>)  <span class="co"># number of reviews</span></span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a>findInq <span class="op">=</span> re.<span class="bu">compile</span>(<span class="vs">r'&lt;span class="inq"&gt;(.*)&lt;/span&gt;'</span>)  <span class="co"># summary</span></span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a>findBd <span class="op">=</span> re.<span class="bu">compile</span>(<span class="vs">r'&lt;p class=""&gt;(.*?)&lt;/p&gt;'</span>, re.S)  <span class="co"># additional info</span></span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-24"><a href="#cb112-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get data from the website</span></span>
<span id="cb112-25"><a href="#cb112-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> getdata(baseurl):</span>
<span id="cb112-26"><a href="#cb112-26" aria-hidden="true" tabindex="-1"></a>    datalist <span class="op">=</span> []</span>
<span id="cb112-27"><a href="#cb112-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">10</span>):</span>
<span id="cb112-28"><a href="#cb112-28" aria-hidden="true" tabindex="-1"></a>        url <span class="op">=</span> baseurl <span class="op">+</span> <span class="bu">str</span>(i <span class="op">*</span> <span class="dv">25</span>)  <span class="co"># Go to the next page</span></span>
<span id="cb112-29"><a href="#cb112-29" aria-hidden="true" tabindex="-1"></a>        html <span class="op">=</span> geturl(url)</span>
<span id="cb112-30"><a href="#cb112-30" aria-hidden="true" tabindex="-1"></a>        soup <span class="op">=</span> BeautifulSoup(html, <span class="st">"html.parser"</span>)</span>
<span id="cb112-31"><a href="#cb112-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> item <span class="kw">in</span> soup.find_all(<span class="st">"div"</span>, class_<span class="op">=</span><span class="st">'item'</span>):  <span class="co"># Extract movie items</span></span>
<span id="cb112-32"><a href="#cb112-32" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> []  <span class="co"># Save movie data</span></span>
<span id="cb112-33"><a href="#cb112-33" aria-hidden="true" tabindex="-1"></a>            item <span class="op">=</span> <span class="bu">str</span>(item)  <span class="co"># Convert to string for regex</span></span>
<span id="cb112-34"><a href="#cb112-34" aria-hidden="true" tabindex="-1"></a>            link <span class="op">=</span> re.findall(findLink, item)[<span class="dv">0</span>]  <span class="co"># Detail link</span></span>
<span id="cb112-35"><a href="#cb112-35" aria-hidden="true" tabindex="-1"></a>            data.append(link)</span>
<span id="cb112-36"><a href="#cb112-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-37"><a href="#cb112-37" aria-hidden="true" tabindex="-1"></a>            imgSrc <span class="op">=</span> re.findall(findImgSrc, item)[<span class="dv">0</span>]  <span class="co"># Image link</span></span>
<span id="cb112-38"><a href="#cb112-38" aria-hidden="true" tabindex="-1"></a>            data.append(imgSrc)</span>
<span id="cb112-39"><a href="#cb112-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-40"><a href="#cb112-40" aria-hidden="true" tabindex="-1"></a>            titles <span class="op">=</span> re.findall(findTitle, item)  <span class="co"># Titles (CN and foreign)</span></span>
<span id="cb112-41"><a href="#cb112-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(titles) <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb112-42"><a href="#cb112-42" aria-hidden="true" tabindex="-1"></a>                data.append(titles[<span class="dv">0</span>])  <span class="co"># Chinese title</span></span>
<span id="cb112-43"><a href="#cb112-43" aria-hidden="true" tabindex="-1"></a>                data.append(titles[<span class="dv">1</span>].replace(<span class="st">"/"</span>, <span class="st">""</span>).strip())  <span class="co"># Foreign title</span></span>
<span id="cb112-44"><a href="#cb112-44" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb112-45"><a href="#cb112-45" aria-hidden="true" tabindex="-1"></a>                data.append(titles[<span class="dv">0</span>])  <span class="co"># Only Chinese title</span></span>
<span id="cb112-46"><a href="#cb112-46" aria-hidden="true" tabindex="-1"></a>                data.append(<span class="st">" "</span>)  <span class="co"># Empty for foreign title</span></span>
<span id="cb112-47"><a href="#cb112-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-48"><a href="#cb112-48" aria-hidden="true" tabindex="-1"></a>            rating <span class="op">=</span> re.findall(findRating, item)[<span class="dv">0</span>]  <span class="co"># Rating</span></span>
<span id="cb112-49"><a href="#cb112-49" aria-hidden="true" tabindex="-1"></a>            data.append(rating)</span>
<span id="cb112-50"><a href="#cb112-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-51"><a href="#cb112-51" aria-hidden="true" tabindex="-1"></a>            judgeNum <span class="op">=</span> re.findall(findJudge, item)[<span class="dv">0</span>]  <span class="co"># Number of reviews</span></span>
<span id="cb112-52"><a href="#cb112-52" aria-hidden="true" tabindex="-1"></a>            data.append(judgeNum)</span>
<span id="cb112-53"><a href="#cb112-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-54"><a href="#cb112-54" aria-hidden="true" tabindex="-1"></a>            inq <span class="op">=</span> re.findall(findInq, item)  <span class="co"># Summary</span></span>
<span id="cb112-55"><a href="#cb112-55" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(inq) <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb112-56"><a href="#cb112-56" aria-hidden="true" tabindex="-1"></a>                data.append(inq[<span class="dv">0</span>].replace(<span class="st">"。"</span>, <span class="st">""</span>))</span>
<span id="cb112-57"><a href="#cb112-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb112-58"><a href="#cb112-58" aria-hidden="true" tabindex="-1"></a>                data.append(<span class="st">" "</span>)</span>
<span id="cb112-59"><a href="#cb112-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-60"><a href="#cb112-60" aria-hidden="true" tabindex="-1"></a>            bd <span class="op">=</span> re.findall(findBd, item)[<span class="dv">0</span>]  <span class="co"># Additional info</span></span>
<span id="cb112-61"><a href="#cb112-61" aria-hidden="true" tabindex="-1"></a>            bd <span class="op">=</span> re.sub(<span class="st">'&lt;br(\s+)?/&gt;(\s+)?'</span>, <span class="st">" "</span>, bd)  <span class="co"># Replace line breaks</span></span>
<span id="cb112-62"><a href="#cb112-62" aria-hidden="true" tabindex="-1"></a>            bd <span class="op">=</span> re.sub(<span class="st">'/'</span>, <span class="st">" "</span>, bd)  <span class="co"># Replace slashes</span></span>
<span id="cb112-63"><a href="#cb112-63" aria-hidden="true" tabindex="-1"></a>            data.append(bd.strip())</span>
<span id="cb112-64"><a href="#cb112-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-65"><a href="#cb112-65" aria-hidden="true" tabindex="-1"></a>            datalist.append(data)</span>
<span id="cb112-66"><a href="#cb112-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> datalist</span>
<span id="cb112-67"><a href="#cb112-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-68"><a href="#cb112-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-69"><a href="#cb112-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to save data to a CSV file</span></span>
<span id="cb112-70"><a href="#cb112-70" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> savedata(datalist, savepath):</span>
<span id="cb112-71"><a href="#cb112-71" aria-hidden="true" tabindex="-1"></a>    headers <span class="op">=</span> [<span class="st">"电影详情链接"</span>, <span class="st">"图片链接"</span>, <span class="st">"影片中文名"</span>, <span class="st">"影片外国名"</span>, <span class="st">"评分"</span>, <span class="st">"评价数"</span>, <span class="st">"概况"</span>, <span class="st">"相关信息"</span>]</span>
<span id="cb112-72"><a href="#cb112-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(savepath, mode<span class="op">=</span><span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>, newline<span class="op">=</span><span class="st">''</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb112-73"><a href="#cb112-73" aria-hidden="true" tabindex="-1"></a>        writer <span class="op">=</span> csv.writer(<span class="bu">file</span>)</span>
<span id="cb112-74"><a href="#cb112-74" aria-hidden="true" tabindex="-1"></a>        writer.writerow(headers)  <span class="co"># Write headers</span></span>
<span id="cb112-75"><a href="#cb112-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> data <span class="kw">in</span> datalist:</span>
<span id="cb112-76"><a href="#cb112-76" aria-hidden="true" tabindex="-1"></a>            writer.writerow(data)  <span class="co"># Write each movie's data</span></span>
<span id="cb112-77"><a href="#cb112-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-78"><a href="#cb112-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-79"><a href="#cb112-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get HTML content from a URL</span></span>
<span id="cb112-80"><a href="#cb112-80" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> geturl(url):</span>
<span id="cb112-81"><a href="#cb112-81" aria-hidden="true" tabindex="-1"></a>    head <span class="op">=</span> {</span>
<span id="cb112-82"><a href="#cb112-82" aria-hidden="true" tabindex="-1"></a>        <span class="st">"User-Agent"</span>: <span class="st">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) "</span></span>
<span id="cb112-83"><a href="#cb112-83" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36"</span></span>
<span id="cb112-84"><a href="#cb112-84" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb112-85"><a href="#cb112-85" aria-hidden="true" tabindex="-1"></a>    req <span class="op">=</span> urllib.request.Request(url, headers<span class="op">=</span>head)</span>
<span id="cb112-86"><a href="#cb112-86" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb112-87"><a href="#cb112-87" aria-hidden="true" tabindex="-1"></a>        response <span class="op">=</span> urllib.request.urlopen(req)</span>
<span id="cb112-88"><a href="#cb112-88" aria-hidden="true" tabindex="-1"></a>        html <span class="op">=</span> response.read().decode(<span class="st">"utf-8"</span>)</span>
<span id="cb112-89"><a href="#cb112-89" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> urllib.error.URLError <span class="im">as</span> e:</span>
<span id="cb112-90"><a href="#cb112-90" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">hasattr</span>(e, <span class="st">"code"</span>):</span>
<span id="cb112-91"><a href="#cb112-91" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(e.code)</span>
<span id="cb112-92"><a href="#cb112-92" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">hasattr</span>(e, <span class="st">"reason"</span>):</span>
<span id="cb112-93"><a href="#cb112-93" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(e.reason)</span>
<span id="cb112-94"><a href="#cb112-94" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">""</span></span>
<span id="cb112-95"><a href="#cb112-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> html</span>
<span id="cb112-96"><a href="#cb112-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-97"><a href="#cb112-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-98"><a href="#cb112-98" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">'__main__'</span>:</span>
<span id="cb112-99"><a href="#cb112-99" aria-hidden="true" tabindex="-1"></a>    main()</span>
<span id="cb112-100"><a href="#cb112-100" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"爬取成功并保存为CSV文件！"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>爬取成功并保存为CSV文件！</code></pre>
</div>
</div>
<div id="cell-2" class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load datasets</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>douban_file_path <span class="op">=</span> <span class="st">'douban_top250.csv'</span>  </span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>imdb_file_path <span class="op">=</span> <span class="st">'IMDB_Top250.csv'</span>      </span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>douban_data <span class="op">=</span> pd.read_csv(douban_file_path, encoding<span class="op">=</span><span class="st">'utf-8'</span>, on_bad_lines<span class="op">=</span><span class="st">'skip'</span>)</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>imdb_data <span class="op">=</span> pd.read_csv(imdb_file_path, encoding<span class="op">=</span><span class="st">'utf-8'</span>, on_bad_lines<span class="op">=</span><span class="st">'skip'</span>)</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Renaming columns for clarity and merging compatibility</span></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>douban_data.rename(columns<span class="op">=</span>{</span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'影片中文名'</span>: <span class="st">'Title'</span>,</span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'评分'</span>: <span class="st">'Douban_Score'</span>,</span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'评价数'</span>: <span class="st">'Douban_Reviews'</span>,</span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'相关信息'</span>: <span class="st">'Douban_Info'</span></span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a>imdb_data.rename(columns<span class="op">=</span>{</span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Name'</span>: <span class="st">'Title'</span>,</span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Year'</span>: <span class="st">'Release_Year'</span>,</span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'IMDB Ranking'</span>: <span class="st">'IMDB_Score'</span>,</span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Genre'</span>: <span class="st">'IMDB_Genre'</span>,</span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Director'</span>: <span class="st">'IMDB_Director'</span></span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average scores for both platforms</span></span>
<span id="cb114-28"><a href="#cb114-28" aria-hidden="true" tabindex="-1"></a>douban_avg_score <span class="op">=</span> douban_data[<span class="st">'Douban_Score'</span>].mean()</span>
<span id="cb114-29"><a href="#cb114-29" aria-hidden="true" tabindex="-1"></a>imdb_avg_score <span class="op">=</span> imdb_data[<span class="st">'IMDB_Score'</span>].mean()</span>
<span id="cb114-30"><a href="#cb114-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-31"><a href="#cb114-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Find overlapping movies by title</span></span>
<span id="cb114-32"><a href="#cb114-32" aria-hidden="true" tabindex="-1"></a>overlap_movies <span class="op">=</span> pd.merge(douban_data, imdb_data, on<span class="op">=</span><span class="st">'Title'</span>)</span>
<span id="cb114-33"><a href="#cb114-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-34"><a href="#cb114-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize average scores</span></span>
<span id="cb114-35"><a href="#cb114-35" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb114-36"><a href="#cb114-36" aria-hidden="true" tabindex="-1"></a>plt.bar([<span class="st">'Douban'</span>, <span class="st">'IMDb'</span>], [douban_avg_score, imdb_avg_score], alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb114-37"><a href="#cb114-37" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Average Scores: Douban vs IMDb'</span>)</span>
<span id="cb114-38"><a href="#cb114-38" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Average Score'</span>)</span>
<span id="cb114-39"><a href="#cb114-39" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb114-40"><a href="#cb114-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-41"><a href="#cb114-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyze release year distribution</span></span>
<span id="cb114-42"><a href="#cb114-42" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb114-43"><a href="#cb114-43" aria-hidden="true" tabindex="-1"></a>douban_data[<span class="st">'Douban_Info'</span>] <span class="op">=</span> douban_data[<span class="st">'Douban_Info'</span>].astype(<span class="bu">str</span>)</span>
<span id="cb114-44"><a href="#cb114-44" aria-hidden="true" tabindex="-1"></a>douban_years <span class="op">=</span> douban_data[<span class="st">'Douban_Info'</span>].<span class="bu">str</span>.extract(<span class="vs">r'(\d</span><span class="sc">{4}</span><span class="vs">)'</span>).dropna()</span>
<span id="cb114-45"><a href="#cb114-45" aria-hidden="true" tabindex="-1"></a>douban_years <span class="op">=</span> douban_years[<span class="dv">0</span>].astype(<span class="bu">int</span>).value_counts().sort_index()</span>
<span id="cb114-46"><a href="#cb114-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-47"><a href="#cb114-47" aria-hidden="true" tabindex="-1"></a>imdb_years <span class="op">=</span> imdb_data[<span class="st">'Release_Year'</span>].value_counts().sort_index()</span>
<span id="cb114-48"><a href="#cb114-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-49"><a href="#cb114-49" aria-hidden="true" tabindex="-1"></a>douban_years.plot(kind<span class="op">=</span><span class="st">'bar'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="st">'Douban'</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb114-50"><a href="#cb114-50" aria-hidden="true" tabindex="-1"></a>imdb_years.plot(kind<span class="op">=</span><span class="st">'bar'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="st">'IMDb'</span>, color<span class="op">=</span><span class="st">'orange'</span>)</span>
<span id="cb114-51"><a href="#cb114-51" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Release Year Distribution'</span>)</span>
<span id="cb114-52"><a href="#cb114-52" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Year'</span>)</span>
<span id="cb114-53"><a href="#cb114-53" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Number of Movies'</span>)</span>
<span id="cb114-54"><a href="#cb114-54" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb114-55"><a href="#cb114-55" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb114-56"><a href="#cb114-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-57"><a href="#cb114-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyze genre distribution</span></span>
<span id="cb114-58"><a href="#cb114-58" aria-hidden="true" tabindex="-1"></a>imdb_genres <span class="op">=</span> imdb_data[<span class="st">'IMDB_Genre'</span>].<span class="bu">str</span>.split(<span class="st">','</span>).explode().<span class="bu">str</span>.strip().value_counts()</span>
<span id="cb114-59"><a href="#cb114-59" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb114-60"><a href="#cb114-60" aria-hidden="true" tabindex="-1"></a>imdb_genres.head(<span class="dv">10</span>).plot(kind<span class="op">=</span><span class="st">'bar'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, color<span class="op">=</span><span class="st">'orange'</span>)</span>
<span id="cb114-61"><a href="#cb114-61" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Top 10 IMDb Genres'</span>)</span>
<span id="cb114-62"><a href="#cb114-62" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Genre'</span>)</span>
<span id="cb114-63"><a href="#cb114-63" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Count'</span>)</span>
<span id="cb114-64"><a href="#cb114-64" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb114-65"><a href="#cb114-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-66"><a href="#cb114-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Top directors by movie count</span></span>
<span id="cb114-67"><a href="#cb114-67" aria-hidden="true" tabindex="-1"></a>douban_directors <span class="op">=</span> douban_data[<span class="st">'Douban_Info'</span>].<span class="bu">str</span>.extract(<span class="vs">r'导演: (.+?) '</span>).dropna()</span>
<span id="cb114-68"><a href="#cb114-68" aria-hidden="true" tabindex="-1"></a>douban_top_directors <span class="op">=</span> douban_directors[<span class="dv">0</span>].value_counts().head(<span class="dv">10</span>)</span>
<span id="cb114-69"><a href="#cb114-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-70"><a href="#cb114-70" aria-hidden="true" tabindex="-1"></a>imdb_top_directors <span class="op">=</span> imdb_data[<span class="st">'IMDB_Director'</span>].value_counts().head(<span class="dv">10</span>)</span>
<span id="cb114-71"><a href="#cb114-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-72"><a href="#cb114-72" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb114-73"><a href="#cb114-73" aria-hidden="true" tabindex="-1"></a>douban_top_directors.plot(kind<span class="op">=</span><span class="st">'bar'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="st">'Douban'</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb114-74"><a href="#cb114-74" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Top 10 Douban Directors'</span>)</span>
<span id="cb114-75"><a href="#cb114-75" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Director'</span>)</span>
<span id="cb114-76"><a href="#cb114-76" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Movie Count'</span>)</span>
<span id="cb114-77"><a href="#cb114-77" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb114-78"><a href="#cb114-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-79"><a href="#cb114-79" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb114-80"><a href="#cb114-80" aria-hidden="true" tabindex="-1"></a>imdb_top_directors.plot(kind<span class="op">=</span><span class="st">'bar'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="st">'IMDb'</span>, color<span class="op">=</span><span class="st">'orange'</span>)</span>
<span id="cb114-81"><a href="#cb114-81" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Top 10 IMDb Directors'</span>)</span>
<span id="cb114-82"><a href="#cb114-82" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Director'</span>)</span>
<span id="cb114-83"><a href="#cb114-83" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Movie Count'</span>)</span>
<span id="cb114-84"><a href="#cb114-84" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb114-85"><a href="#cb114-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-86"><a href="#cb114-86" aria-hidden="true" tabindex="-1"></a><span class="co"># Save overlapping movies to a CSV file</span></span>
<span id="cb114-87"><a href="#cb114-87" aria-hidden="true" tabindex="-1"></a>overlap_movies.to_csv(<span class="st">'overlap_movies.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb114-88"><a href="#cb114-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-89"><a href="#cb114-89" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb114-90"><a href="#cb114-90" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"豆瓣平均评分: </span><span class="sc">{</span>douban_avg_score<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb114-91"><a href="#cb114-91" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"IMDb平均评分: </span><span class="sc">{</span>imdb_avg_score<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb114-92"><a href="#cb114-92" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"重叠电影数量: </span><span class="sc">{</span><span class="bu">len</span>(overlap_movies)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="practice_files/figure-html/labs-Practice-Practice4-cell-4-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="practice_files/figure-html/labs-Practice-Practice4-cell-4-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="practice_files/figure-html/labs-Practice-Practice4-cell-4-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="practice_files/figure-html/labs-Practice-Practice4-cell-4-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="practice_files/figure-html/labs-Practice-Practice4-cell-4-output-5.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>豆瓣平均评分: 8.9396
IMDb平均评分: 8.254
重叠电影数量: 0</code></pre>
</div>
</div>
<a class="quarto-notebook-link" id="nblink-6" href="labs/Practice/Practice4-preview.html#cell-0">Source: compile返回的是匹配到的模式对象</a></div>
</section>
<section id="practice4-recreate_graph" class="level1">
<h1>Practice4-recreate_graph</h1>
<div class="quarto-embed-nb-cell">
<div id="cell-0" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pingouin <span class="im">as</span> pg</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> lets_plot <span class="im">import</span> <span class="op">*</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>LetsPlot.setup_html(no_js<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-1" class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>read_file <span class="op">=</span> pd.read_excel (<span class="st">"D:</span><span class="ch">\360</span><span class="st">MoveData\Users</span><span class="ch">\75</span><span class="st">903\Desktop\SuYibo-Homework\Practice2 SuYibo/Public-goods-experimental-data.xlsx"</span>) </span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>read_file.to_csv (<span class="st">"Public-goods-experimental-data.csv"</span>, </span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>                index <span class="op">=</span> <span class="va">None</span>, </span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>                header<span class="op">=</span><span class="va">True</span>) </span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(pd.read_csv(<span class="st">"Public-goods-experimental-data.csv"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-2" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Contributions without punishment (Figure 3 in Herrmann, Thoni, and Gachter (2008))</th>
<th data-quarto-table-cell-role="th">Unnamed: 1</th>
<th data-quarto-table-cell-role="th">Unnamed: 2</th>
<th data-quarto-table-cell-role="th">Unnamed: 3</th>
<th data-quarto-table-cell-role="th">Unnamed: 4</th>
<th data-quarto-table-cell-role="th">Unnamed: 5</th>
<th data-quarto-table-cell-role="th">Unnamed: 6</th>
<th data-quarto-table-cell-role="th">Unnamed: 7</th>
<th data-quarto-table-cell-role="th">Unnamed: 8</th>
<th data-quarto-table-cell-role="th">Unnamed: 9</th>
<th data-quarto-table-cell-role="th">Unnamed: 10</th>
<th data-quarto-table-cell-role="th">Unnamed: 11</th>
<th data-quarto-table-cell-role="th">Unnamed: 12</th>
<th data-quarto-table-cell-role="th">Unnamed: 13</th>
<th data-quarto-table-cell-role="th">Unnamed: 14</th>
<th data-quarto-table-cell-role="th">Unnamed: 15</th>
<th data-quarto-table-cell-role="th">Unnamed: 16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Period</td>
<td>Copenhagen</td>
<td>Dnipropetrovs’k</td>
<td>Minsk</td>
<td>St. Gallen</td>
<td>Muscat</td>
<td>Samara</td>
<td>Zurich</td>
<td>Boston</td>
<td>Bonn</td>
<td>Chengdu</td>
<td>Seoul</td>
<td>Riyadh</td>
<td>Nottingham</td>
<td>Athens</td>
<td>Istanbul</td>
<td>Melbourne</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>14.102941176470589</td>
<td>10.954545272727273</td>
<td>12.7941</td>
<td>13.6875</td>
<td>9.53846</td>
<td>10.8421</td>
<td>11.0833</td>
<td>12.9643</td>
<td>10.85</td>
<td>10</td>
<td>8.249999904761905</td>
<td>7.958333416666666</td>
<td>10.928571428571429</td>
<td>8.136363818181819</td>
<td>8.9375</td>
<td>8.225</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>14.132352941176471</td>
<td>12.636363454545455</td>
<td>12.3382</td>
<td>12.80206675</td>
<td>10.9808</td>
<td>11.5</td>
<td>12.1667</td>
<td>12.7143</td>
<td>10.8</td>
<td>9.9625</td>
<td>9.142857142857142</td>
<td>7.729166916666666</td>
<td>10.535714285714286</td>
<td>6.2727272727272725</td>
<td>9.015625</td>
<td>7.325</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>13.720588235294118</td>
<td>12.068181636363636</td>
<td>12.5882</td>
<td>12.354183500000001</td>
<td>11.5192</td>
<td>11.7237</td>
<td>10.7813</td>
<td>12.7143</td>
<td>11.516666666666666</td>
<td>10.225</td>
<td>9.892857238095237</td>
<td>7.1875</td>
<td>9.125000142857143</td>
<td>6.409090636363637</td>
<td>8.4375</td>
<td>6.25</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>12.897058823529411</td>
<td>11.181818</td>
<td>12.2647</td>
<td>10.60418325</td>
<td>10.3077</td>
<td>11.3092</td>
<td>10.6354</td>
<td>11.3571</td>
<td>10.7</td>
<td>10.0125</td>
<td>9.666666666666666</td>
<td>7.875000166666666</td>
<td>8.982142857142858</td>
<td>6.3181815454545465</td>
<td>6.921875125</td>
<td>5.975</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<a class="quarto-notebook-link" id="nblink-7" href="labs/Practice/recreate_graph-preview.html#cell-0">Source: recreate_graph.ipynb</a></div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>